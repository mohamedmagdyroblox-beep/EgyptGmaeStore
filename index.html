<!DOCTYPE html>
<html lang="ar">

    <!-- ✅ SEO Title + Description -->
    <title>اشتري روبكس في مصر | EgyptGameShop  & </title>
    <meta name="description"
        content="اشتري روبكس من خلال انستا باي و فودافون كاش في مصر | Buy Robux and Murder Mystery 2 and Blox Fruit in Egypt using  and .">

    <!-- ✅ Canonical URL (tells Google which version to index) -->
    <link rel="canonical" href="https://egyptgameshop.com/" />

    <!-- ✅ EgyptGameShop Structured Data (Full SEO Optimized Version) -->
    <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@graph": [
      {
        "@type": "WebSite",
        "name": "EgyptGameShop",
        "url": "https://egyptgameshop.com/",
        "potentialAction": {
          "@type": "SearchAction",
          "target": "https://egyptgameshop.com/?s={search_term_string}",
          "query-input": "required name=search_term_string"
        }
      },
      {
        "@type": "Organization",
        "name": "EgyptGameShop",
        "url": "https://egyptgameshop.com/",
        "logo": "https://res.cloudinary.com/ddypg7s3v/image/upload/v1764297465/5812402267456474193_spefop.jpg",
        "sameAs": [
          "https://www.facebook.com/profile.php?id=61581826985292",
          "https://discord.com/invite/pCYvMsmScW"
        ]
      },
      {
        "@type": "Product",
        "name": "500 Robux",
        "image": "https://egyptgameshop.com/images/500robux.jpg",
        "description": "اشتري 500 روبكس من خلال انستا باي و فودافون كاش بسهولة وافضل سعر في مصر EgyptGameShop.",
        "brand": { "@type": "Brand", "name": "Roblox" },
        "aggregateRating": { "@type": "AggregateRating", "ratingValue": "5.0", "reviewCount": "28" },
        "offers": {
          "@type": "Offer",
          "url": "https://egyptgameshop.com/",
          "priceCurrency": "EGP",
          "price": "140",
          "priceValidUntil": "2026-10-10",
          "availability": "https://schema.org/InStock",
          "itemCondition": "https://schema.org/NewCondition"
        }
      },
      {
        "@type": "Product",
        "name": "1000 Robux",
        "image": "https://egyptgameshop.com/images/1000robux.jpg",
        "description": "اشتري 1000 روبكس من خلال انستا باي و فودافون كاش بسهولة وافضل سعر في مصر EgyptGameShop.",
        "brand": { "@type": "Brand", "name": "Roblox" },
        "aggregateRating": { "@type": "AggregateRating", "ratingValue": "5.0", "reviewCount": "42" },
        "offers": {
          "@type": "Offer",
          "url": "https://egyptgameshop.com/",
          "priceCurrency": "EGP",
          "price": "270",
          "priceValidUntil": "2026-10-10",
          "availability": "https://schema.org/InStock",
          "itemCondition": "https://schema.org/NewCondition"
        }
      },
      {
        "@type": "Product",
        "name": "2000 Robux",
        "image": "https://egyptgameshop.com/images/2000robux.jpg",
        "description": "اشتري 2000 روبكس من خلال انستا باي و فودافون كاش بسهولة وافضل سعر في مصر EgyptGameShop.",
        "brand": { "@type": "Brand", "name": "Roblox" },
        "aggregateRating": { "@type": "AggregateRating", "ratingValue": "4.9", "reviewCount": "35" },
        "offers": {
          "@type": "Offer",
          "url": "https://egyptgameshop.com/",
          "priceCurrency": "EGP",
          "price": "510",
          "priceValidUntil": "2026-10-10",
          "availability": "https://schema.org/InStock",
          "itemCondition": "https://schema.org/NewCondition"
        }
      },
      {
        "@type": "Product",
        "name": "5000 Robux",
        "image": "https://egyptgameshop.com/images/5000robux.jpg",
        "description": "اشتري 5000 روبكس من خلال انستا باي و فودافون كاش بسهولة وافضل سعر في مصر EgyptGameShop.",
        "brand": { "@type": "Brand", "name": "Roblox" },
        "aggregateRating": { "@type": "AggregateRating", "ratingValue": "5.0", "reviewCount": "51" },
        "offers": {
          "@type": "Offer",
          "url": "https://egyptgameshop.com/",
          "priceCurrency": "EGP",
          "price": "1250",
          "priceValidUntil": "2026-10-10",
          "availability": "https://schema.org/InStock",
          "itemCondition": "https://schema.org/NewCondition"
        }
      }
    ]
  }
  </script>
    
    <!-- Early console error suppression -->
    <script>
        // Suppress Cross-Origin-Opener-Policy console errors early
        (function() {
            const originalError = console.error;
            const originalWarn = console.warn;
            
            console.error = function(...args) {
                const message = args.join(' ');
                if (message.includes('Cross-Origin-Opener-Policy') || 
                    message.includes('window.close call') ||
                    message.includes('popup.ts')) {
                    return;
                }
                originalError.apply(console, args);
            };
            
            console.warn = function(...args) {
                const message = args.join(' ');
                if (message.includes('Cross-Origin-Opener-Policy') || 
                    message.includes('window.close call') ||
                    message.includes('popup.ts')) {
                    return;
                }
                originalWarn.apply(console, args);
            };
        })();
    </script>

    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="Cross-Origin-Opener-Policy" content="same-origin-allow-popups" />

    <!-- ✅ Open Graph & Twitter (for Google/Facebook Preview) -->
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://egyptgameshop.com/" />
    <meta property="og:title" content="اشتري روبكس في مصر | EgyptGameShop  & " />
    <meta property="og:description"
        content="اشتري روبكس من خلال انستا باي و فودافون كاش في مصر | Buy Robux and Murder Mystery 2 and Blox Fruit in Egypt by  and ." />
    <meta property="og:image" content="https://egyptgameshop.com/og-image.jpg" />

    <meta property="twitter:card" content="summary_large_image" />
    <meta property="twitter:url" content="https://egyptgameshop.com/" />
    <meta property="twitter:title" content="اشتري روبكس في مصر | EgyptGameShop  & " />
    <meta property="twitter:description"
        content="اشتري روبكس من خلال انستا باي و فودافون كاش في مصر | Buy Robux and Murder Mystery 2 and Blox Fruit in Egypt by  and ." />
    <meta property="twitter:image" content="https://egyptgameshop.com/og-image.jpg" />

    <!-- Favicon for Google Search Results -->
    <link rel="icon" href="https://egyptgameshop.com/site_tab_icon.jpg" type="image/jpeg" sizes="any">
    <link rel="shortcut icon" href="https://egyptgameshop.com/site_tab_icon.jpg" type="image/jpeg">
    <link rel="apple-touch-icon" href="https://egyptgameshop.com/site_tab_icon.jpg">
    <link rel="icon" type="image/jpeg" href="https://egyptgameshop.com/site_tab_icon.jpg" sizes="16x16">
    <link rel="icon" type="image/jpeg" href="https://egyptgameshop.com/site_tab_icon.jpg" sizes="32x32">
    <link rel="icon" type="image/jpeg" href="https://egyptgameshop.com/site_tab_icon.jpg" sizes="192x192">
    <link rel="icon" type="image/jpeg" href="https://egyptgameshop.com/site_tab_icon.jpg" sizes="512x512">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" />
    <style>
        /* ✅ Moved your CSS here — this is the fix */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Poppins', sans-serif;
        }

        :root {
            --primary: #4285f4;
            --secondary: #6fa8f5;
            --accent: #ff5722;
            --discord: #5865F2;
            --facebook: #1877f2;
            --light: #f8fafc;
            --dark: #1e293b;
            --darker: #0f172a;
            --gray: #64748b;
            --success: #22c55e;
            --error: #ef4444;
            --warning: #f59e0b;
            --card-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
            --hover-transform: translateY(-10px);
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%);
            color: var(--dark);
            line-height: 1.6;
            min-height: 100vh;
            width: 100%;
            overflow-x: hidden;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        header {
            background: linear-gradient(135deg, #4285f4 0%, #6fa8f5 100%);
            color: white;
            padding: 15px 0;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 26px;
            font-weight: 700;
            display: flex;
            align-items: center;
            color: white;
        }

        .logo i {
            margin-right: 12px;
            font-size: 32px;
            background: var(--accent);
            color: white;
            padding: 8px;
            border-radius: 10px;
            transition: transform 0.3s ease;
        }

        .logo:hover i {
            transform: rotate(15deg);
        }

        .logo span {
            color: #ffdd40;
        }

        nav ul {
            display: flex;
            list-style: none;
        }

        nav ul li {
            margin-left: 20px;
        }

        nav ul li a {
            color: white;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.3s ease;
            padding: 8px 15px;
            border-radius: 6px;
            position: relative;
        }

        nav ul li a::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            width: 0;
            height: 2px;
            background: white;
            transition: all 0.3s ease;
            transform: translateX(-50%);
        }

        nav ul li a:hover::after {
            width: 80%;
        }

        nav ul li a:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        .user-menu {
            display: flex;
            align-items: center;
            gap: 10px;
            position: relative;
            margin-left: 30px;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 8px;
            color: white;
            font-weight: 500;
            max-width: 150px;
            overflow: hidden;
        }

        .user-info span {
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .user-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            color: white;
            flex-shrink: 0;
        }

        .auth-dropdown {
            position: absolute;
            top: 100%;
            right: 0;
            margin-top: 10px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
            width: 320px;
            padding: 20px;
            z-index: 1000;
            display: none;
            animation: slideDown 0.3s ease;
            border: 1px solid #e2e8f0;
            max-height: 500px;
            overflow-y: auto;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .auth-dropdown.active {
            display: block;
        }

        .auth-tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 1px solid #e2e8f0;
        }

        .auth-tab {
            flex: 1;
            text-align: center;
            padding: 12px;
            font-weight: 600;
            color: var(--gray);
            cursor: pointer;
            position: relative;
            transition: all 0.3s ease;
            font-size: 14px;
        }

        .auth-tab.active {
            color: var(--primary);
        }

        .auth-tab.active::after {
            content: '';
            position: absolute;
            bottom: -1px;
            left: 0;
            width: 100%;
            height: 2px;
            background: var(--primary);
        }

        .auth-form {
            display: none;
        }

        .auth-form.active {
            display: block;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: var(--darker);
            font-size: 14px;
        }

        .form-group input {
            width: 100%;
            padding: 10px 15px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .form-group input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(66, 133, 244, 0.1);
        }

        .form-note {
            font-size: 0.8rem;
            color: var(--gray);
            margin-top: 5px;
            font-style: italic;
        }

        .btn-auth {
            width: 100%;
            padding: 12px;
            border: none;
            border-radius: 8px;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
        }

        .btn-auth:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(66, 133, 244, 0.3);
        }

        .forgot-password {
            text-align: center;
            margin-top: 10px;
        }

        .forgot-password a {
            color: var(--primary);
            text-decoration: none;
            font-size: 13px;
            font-weight: 500;
        }

        .forgot-password a:hover {
            text-decoration: underline;
        }

        .google-login {
            margin-top: 15px;
            text-align: center;
        }

        .google-login p {
            font-size: 14px;
            color: var(--gray);
            margin-bottom: 10px;
            position: relative;
        }

        .google-login p::before,
        .google-login p::after {
            content: '';
            position: absolute;
            top: 50%;
            width: 40%;
            height: 1px;
            background: #e2e8f0;
        }

        .google-login p::before {
            left: 0;
        }

        .google-login p::after {
            right: 0;
        }

        .btn-google {
            width: 100%;
            padding: 10px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            background: white;
            color: var(--dark);
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .btn-google:hover {
            border-color: #dadce0;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .btn-google i {
            color: #4285f4;
            font-size: 18px;
        }

        .discord-banner {
            background: linear-gradient(90deg, var(--discord) 0%, #7289da 100%);
            color: white;
            text-align: center;
            padding: 18px 20px;
            /* Increased padding for better spacing */
            font-weight: 500;
            font-size: 15px;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 12px rgba(88, 101, 242, 0.3);
        }

        .discord-banner a {
            color: white;
            text-decoration: underline;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            transition: all 0.3s ease;
            margin: 0 8px;
            /* Added margin for spacing */
        }

        .discord-banner a:hover {
            transform: scale(1.05);
        }

        .discord-banner i {
            margin-right: 16px;
            /* Increased spacing */
            font-size: 20px;
            /* Slightly larger icon */
        }

        .facebook-banner {
            background: linear-gradient(90deg, var(--facebook) 0%, #2d88ff 100%);
            color: white;
            text-align: center;
            padding: 18px 20px;
            font-weight: 500;
            font-size: 15px;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 12px rgba(24, 119, 242, 0.3);
        }

        .facebook-banner a {
            color: white;
            text-decoration: underline;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            transition: all 0.3s ease;
            margin: 0 8px;
        }

        .facebook-banner a:hover {
            transform: scale(1.05);
        }

        .facebook-banner i {
            margin-right: 16px;
            font-size: 20px;
        }
        
.whatsapp-banner {
    background: linear-gradient(90deg, #4CFF8A 0%, #27D97B 100%);
    color: white;
    text-align: center;
    padding: 18px 20px;
    font-weight: 500;
    font-size: 15px;
    position: relative;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 4px 12px rgba(76, 255, 138, 0.3);
}

.whatsapp-banner a {
    color: white;
    text-decoration: underline;
    font-weight: 600;
    display: inline-flex;
    align-items: center;
    transition: all 0.3s ease;
    margin: 0 8px;
}

.whatsapp-banner a:hover {
    transform: scale(1.05);
}

.whatsapp-banner i {
    margin-right: 16px;
    font-size: 20px;
}

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            border-radius: 8px;
            color: white;
            font-weight: 500;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            z-index: 10000;
            transform: translateX(120%);
            transition: transform 0.3s ease;
            display: flex;
            align-items: center;
            max-width: 300px;
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification i {
            margin-right: 10px;
            font-size: 18px;
        }

        .notification.success {
            background: var(--success);
        }

        .notification.error {
            background: var(--error);
        }

        .notification.info {
            background: var(--primary);
        }

        .notification.warning {
            background: var(--warning);
        }

        .hero {
            text-align: center;
            padding: 100px 0;
            background: linear-gradient(135deg, #4285f4 0%, #6fa8f5 100%);
            position: relative;
            overflow: hidden;
        }

        .hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(66, 133, 244, 0.9) 0%, rgba(111, 168, 245, 0.9) 100%);
            z-index: 0;
        }

        .hero .container {
            position: relative;
            z-index: 1;
        }

        .hero h1 {
            font-size: 4rem;
            margin-bottom: 20px;
            color: white;
            font-weight: 800;
            animation: fadeInUp 0.8s ease forwards;
            opacity: 0;
        }

        .hero p {
            font-size: 1.5rem;
            color: #E9F2F9;
            max-width: 700px;
            margin: 0 auto 20px;
            animation: fadeInUp 0.8s ease 0.2s forwards;
            opacity: 0;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            padding: 16px 35px;
            border-radius: 50px;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
            border: none;
            cursor: pointer;
            margin: 8px;
            box-shadow: 0 4px 15px rgba(66, 133, 244, 0.3);
            position: relative;
            overflow: hidden;
            z-index: 1;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.2);
            transform: translateX(-100%);
            transition: transform 0.5s ease;
            z-index: -1;
        }

        .btn:hover::before {
            transform: translateX(0);
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(66, 133, 244, 0.4);
        }

        .btn i {
            margin-right: 10px;
        }

        .btn-discord {
            background: var(--discord);
            box-shadow: 0 4px 15px rgba(88, 101, 242, 0.3);
        }

        .btn-discord:hover {
            box-shadow: 0 8px 25px rgba(88, 101, 242, 0.4);
        }

        .btn-facebook {
            background: var(--facebook);
            box-shadow: 0 4px 15px rgba(24, 119, 242, 0.3);
        }

        .btn-facebook:hover {
            box-shadow: 0 8px 25px rgba(24, 119, 242, 0.4);
        }

        .btn-outline {
            background: transparent;
            border: 2px solid var(--primary);
            color: white;
            padding: 12px 25px;
            font-size: 14px;
        }

        .btn-outline:hover {
            background: rgba(66, 133, 244, 0.1);
        }

        .btn-small {
            padding: 8px 16px;
            font-size: 0.9rem;
        }

        .hero-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 30px;
            animation: fadeInUp 0.8s ease 0.4s forwards;
            opacity: 0;
        }

        .products {
            padding: 60px 0;
            background: white;
        }

        .section-title {
            text-align: center;
            margin-bottom: 50px;
        }

        .section-title h2 {
            font-size: 2.8rem;
            color: var(--darker);
            margin-bottom: 15px;
            font-weight: 700;
            position: relative;
            display: inline-block;
        }

        .section-title h2::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 50%;
            width: 60px;
            height: 4px;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            transform: translateX(-50%);
            border-radius: 2px;
        }

        .section-title p {
            color: var(--gray);
            font-size: 1.2rem;
            max-width: 700px;
            margin: 20px auto 0;
        }

        .category-tabs {
            display: flex;
            justify-content: center;
            margin-bottom: 40px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .category-tab {
            padding: 14px 28px;
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 50px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            color: var(--gray);
            position: relative;
            overflow: hidden;
            z-index: 1;
        }

        .category-tab::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 0;
            height: 100%;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            transition: width 0.3s ease;
            z-index: -1;
        }

        .category-tab.active {
            color: white;
            border-color: transparent;
            box-shadow: 0 5px 15px rgba(66, 133, 244, 0.2);
        }

        .category-tab.active::before {
            width: 100%;
        }

        .category-tab:hover:not(.active) {
            border-color: var(--primary);
            color: var(--primary);
        }

        .product-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 30px;
        }

        .product-card {
            background: white;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: var(--card-shadow);
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            border: 1px solid #f1f5f9;
            position: relative;
            height: 100%;
        }

        .product-card::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(66, 133, 244, 0.05) 0%, rgba(111, 168, 245, 0.05) 100%);
            opacity: 0;
            transition: opacity 0.3s ease;
            pointer-events: none;
        }

        .product-card:hover {
            transform: var(--hover-transform);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.12);
        }

        .product-card:hover::after {
            opacity: 1;
        }

        .product-image {
            height: 200px;
            background: linear-gradient(45deg, var(--primary) 0%, var(--secondary) 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 70px;
            position: relative;
            overflow: hidden;
            background-size: contain;
            background-position: center;
            background-repeat: no-repeat;
            background-color: #f0f9ff;
        }

        /* Ensure inline <img> inside product-image do not crop */
        .product-image img {
            width: 100%;
            height: 100%;
            object-fit: contain !important;
        }

        .product-image::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255, 255, 255, 0.2) 0%, rgba(255, 255, 255, 0) 70%);
            transform: scale(0);
            transition: transform 0.5s ease;
        }

        .product-card:hover .product-image::before {
            transform: scale(1);
        }

        /* Hide ALL static products by default - only show Firebase products */
        .product-card, .mm2-product-card {
            display: none !important;
        }
        
        /* Show only dynamically created products from Firebase */
        .firebase-product {
            display: block !important;
        }

        .product-badge {
            position: absolute;
            top: 15px;
            right: 15px;
            background: var(--accent);
            color: white;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            z-index: 2;
            animation: pulse 2s infinite;
        }

        .product-content {
            padding: 25px;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
        }

        .product-title {
            font-size: 1.4rem;
            margin-bottom: 12px;
            color: var(--darker);
            font-weight: 600;
        }

        .product-desc {
            color: var(--gray);
            margin-bottom: 20px;
            font-size: 1rem;
            flex-grow: 1;
            line-height: 1.5;
        }

        .product-price {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
        }

        .product-price::before {
            content: "EGP";
            font-size: 1rem;
            margin-right: 5px;
            color: var(--gray);
            font-weight: 500;
        }

        .product-tax-note {
            font-size: 0.8rem;
            color: var(--gray);
            margin-bottom: 15px;
            font-style: italic;
        }

        .product-actions {
            display: flex;
            gap: 12px;
        }

        .btn-product {
            flex: 1;
            text-align: center;
            padding: 12px 20px;
            border-radius: 10px;
            font-weight: 600;
            transition: all 0.3s ease;
            cursor: pointer;
            border: none;
            color: white;
        }

        .btn-buy {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            box-shadow: 0 4px 10px rgba(66, 133, 244, 0.25);
        }

        .btn-buy:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(66, 133, 244, 0.35);
        }

        .order-history {
            padding: 80px 0;
            background: white;
        }

        .order-list {
            margin-top: 40px;
        }

        .order-item {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            border: 1px solid #e2e8f0;
            transition: all 0.3s ease;
        }

        .order-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        }

        .order-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px solid #e2e8f0;
        }

        .order-id {
            font-weight: 600;
            color: var(--primary);
            font-size: 1.1rem;
        }

        .order-date {
            color: var(--gray);
            font-size: 0.9rem;
        }

        .order-status {
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .status-pending {
            background: #fef3c7;
            color: #92400e;
        }

        .status-completed {
            background: #d1fae5;
            color: #065f46;
        }

        .order-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .order-details-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .order-detail-item {
            display: flex;
            flex-direction: column;
        }

        .order-detail-label {
            font-size: 0.8rem;
            color: var(--gray);
            margin-bottom: 5px;
        }

        .order-detail-value {
            font-weight: 500;
            color: var(--darker);
        }

        .empty-orders {
            text-align: center;
            padding: 40px;
            color: var(--gray);
        }

        .empty-orders i {
            font-size: 60px;
            margin-bottom: 20px;
            color: var(--gray);
        }

        .user-settings-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 3500;
            overflow: auto;
        }

        .user-settings-modal.active {
            display: block;
        }

        .user-settings-content {
            background-color: white;
            margin: 5% auto;
            padding: 35px;
            border-radius: 20px;
            width: 90%;
            max-width: 600px;
            position: relative;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.15);
            border: 1px solid #f1f5f9;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from {
                transform: translateY(-50px);
                opacity: 0;
            }

            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .settings-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #e2e8f0;
        }

        .settings-title {
            font-size: 1.8rem;
            color: var(--darker);
            font-weight: 700;
        }

        .settings-tabs {
            display: flex;
            margin-bottom: 30px;
            border-bottom: 1px solid #e2e8f0;
        }

        .settings-tab {
            flex: 1;
            text-align: center;
            padding: 15px;
            font-weight: 600;
            color: var(--gray);
            cursor: pointer;
            position: relative;
            transition: all 0.3s ease;
        }

        .settings-tab.active {
            color: var(--primary);
        }

        .settings-tab.active::after {
            content: '';
            position: absolute;
            bottom: -1px;
            left: 0;
            width: 100%;
            height: 2px;
            background: var(--primary);
        }

        .settings-form {
            display: none;
        }

        .settings-form.active {
            display: block;
        }

        .settings-form .form-group {
            margin-bottom: 25px;
        }

        .settings-form label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: var(--darker);
        }

        .settings-form input {
            width: 100%;
            padding: 15px 20px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .settings-form input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(66, 133, 244, 0.1);
        }

        .btn-save {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            border: none;
            padding: 14px 30px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-save:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(66, 133, 244, 0.3);
        }

        .features {
            padding: 80px 0;
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
        }

        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
        }

        .feature-card {
            background: white;
            border-radius: 20px;
            padding: 35px 30px;
            text-align: center;
            transition: all 0.3s ease;
            border: 1px solid #f1f5f9;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.05);
        }

        .feature-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
        }

        .feature-icon {
            font-size: 60px;
            margin-bottom: 25px;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            display: inline-block;
            transition: transform 0.3s ease;
        }

        .feature-card:hover .feature-icon {
            transform: scale(1.1);
        }

        .feature-card h3 {
            font-size: 1.5rem;
            margin-bottom: 15px;
            color: var(--darker);
            font-weight: 600;
        }

        .feature-card p {
            color: var(--gray);
            line-height: 1.6;
        }

        .how-it-works {
            padding: 80px 0;
            background: white;
        }

        .steps {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 40px;
        }

        .step {
            text-align: center;
            position: relative;
            padding: 0 20px;
        }

        .step-number {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            font-weight: 700;
            margin: 0 auto 25px;
            position: relative;
            box-shadow: 0 10px 20px rgba(66, 133, 244, 0.2);
            transition: transform 0.3s ease;
        }

        .step:hover .step-number {
            transform: scale(1.1);
        }

        .step h3 {
            font-size: 1.4rem;
            margin-bottom: 15px;
            color: var(--darker);
            font-weight: 600;
        }

        .step p {
            color: var(--gray);
            line-height: 1.6;
        }

        .payment-methods {
            padding: 80px 0;
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
        }

        .payment-icons {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 40px;
            margin-top: 40px;
        }

        .payment-icon-large {
            font-size: 60px;
            color: var(--dark);
            display: flex;
            flex-direction: column;
            align-items: center;
            transition: all 0.3s ease;
        }

        .payment-icon-large:hover {
            transform: translateY(-5px);
            color: var(--primary);
        }

        .payment-icon-large span {
            font-size: 16px;
            margin-top: 15px;
            color: var(--gray);
            font-weight: 500;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 3000;
            overflow: auto;
            animation: fadeIn 0.3s ease;
        }

        .modal.active {
            display: block;
        }

        .modal-content {
            background-color: white;
            margin: 5% auto;
            padding: 40px;
            border-radius: 15px;
            width: 90%;
            max-width: 500px;
            position: relative;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            border: 1px solid #e2e8f0;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #f1f5f9;
        }

        .modal-header h3 {
            margin: 0;
            color: #1e293b;
            font-size: 24px;
            font-weight: 700;
        }

        .close {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 18px;
            color: #64748b;
            transition: all 0.2s ease;
        }

        .close:hover {
            background: #f1f5f9;
            color: #475569;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #374151;
            font-size: 14px;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.2s ease;
            background: #ffffff;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .btn {
            padding: 12px 24px;
            border-radius: 8px;
            font-weight: 600;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s ease;
            border: none;
        }

        .btn-primary {
            background: #3b82f6;
            color: white;
        }

        .btn-primary:hover {
            background: #2563eb;
        }

        .btn-outline {
            background: white;
            color: #64748b;
            border: 2px solid #e2e8f0;
        }

        .btn-outline:hover {
            background: #f8fafc;
            border-color: #cbd5e1;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        .modal-content {
            background-color: white;
            margin: 5% auto;
            padding: 35px;
            border-radius: 20px;
            width: 90%;
            max-width: 600px;
            position: relative;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.15);
            border: 1px solid #f1f5f9;
            animation: slideIn 0.3s ease;
        }

        .close {
            position: absolute;
            top: 20px;
            right: 25px;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            color: var(--gray);
            transition: all 0.3s ease;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            background: #f8fafc;
            border: 1px solid #e2e8f0;
        }

        .close:hover {
            color: var(--error);
            background: #fef2f2;
            transform: rotate(90deg);
        }

        .order-summary {
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 25px;
            border: 1px solid #e2e8f0;
        }

        .order-summary h3 {
            margin-bottom: 20px;
            color: var(--darker);
            font-weight: 600;
            display: flex;
            align-items: center;
        }

        .order-summary h3 i {
            margin-right: 10px;
            color: var(--primary);
        }

        .order-item-summary {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px solid #e2e8f0;
        }

        .order-item-summary:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }

        .order-item-name {
            color: var(--darker) !important;
            font-weight: 500 !important;
            font-size: 1.1rem !important;
        }

        .order-item-price {
            color: var(--primary) !important;
            font-weight: 600 !important;
            font-size: 1.1rem !important;
        }

        .order-tax-note {
            font-size: 0.8rem;
            color: var(--gray);
            font-style: italic;
            text-align: right;
            margin-top: 5px;
        }

        .order-total {
            display: flex;
            justify-content: space-between;
            font-weight: bold;
            font-size: 1.3rem;
            padding-top: 15px;
            margin-top: 15px;
            border-top: 2px solid #e2e8f0;
            color: var(--darker);
        }

        .payment-section {
            display: none;
            margin-top: 25px;
        }

        .payment-section h3 {
            margin-bottom: 20px;
            color: var(--darker);
            font-weight: 600;
            display: flex;
            align-items: center;
        }

        .payment-section h3 i {
            margin-right: 10px;
            color: var(--primary);
        }

        .payment-options {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
            margin-bottom: 25px;
        }

        .payment-option {
            display: flex;
            align-items: center;
            padding: 20px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            background: white;
        }

        .payment-option:hover {
            border-color: var(--primary);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
        }

        .payment-option.selected {
            border-color: var(--primary);
            background: rgba(66, 133, 244, 0.05);
            position: relative;
        }

        .payment-option.selected::after {
            content: "✓";
            position: absolute;
            top: -12px;
            right: -12px;
            background: var(--success);
            color: white;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 14px;
            box-shadow: 0 3px 10px rgba(34, 197, 94, 0.3);
        }

        .payment-option input {
            margin-right: 15px;
            width: 20px;
            height: 20px;
        }

        .payment-icon {
            font-size: 32px;
            margin-right: 15px;
            color: var(--dark);
            width: 40px;
            text-align: center;
        }

        .payment-details {
            flex-grow: 1;
        }

        .payment-details h4 {
            margin-bottom: 5px;
            color: var(--darker);
            font-weight: 600;
        }

        .payment-details p {
            color: var(--gray);
            font-size: 0.9rem;
            line-height: 1.4;
        }

        .payment-instructions {
            background: white;
            padding: 25px;
            border-radius: 15px;
            margin: 25px 0;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            border: 1px solid #e2e8f0;
            display: none;
        }

        .payment-instructions h4 {
            margin-bottom: 20px;
            color: var(--primary);
            font-size: 1.3rem;
            font-weight: 600;
            display: flex;
            align-items: center;
        }

        .payment-instructions h4 i {
            margin-right: 10px;
        }

        .payment-amount {
            font-size: 2rem;
            font-weight: 800;
            color: var(--primary);
            margin: 20px 0;
            text-align: center;
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
            padding: 15px;
            border-radius: 12px;
            border: 2px dashed #e2e8f0;
        }

        .payment-qr-container {
            display: flex;
            justify-content: center;
            margin: 20px 0;
        }

        .payment-qr {
            max-width: 200px;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 10px;
            background: white;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .payment-qr img {
            width: 100%;
            height: auto;
            display: block;
        }

        .payment-email {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--darker);
            margin: 15px 0;
            text-align: center;
            padding: 10px;
            background: #f8fafc;
            border-radius: 8px;
            border: 1px solid #e2e8f0;
        }

        .payment-link {
            display: block;
            text-align: center;
            margin: 15px 0;
            padding: 12px;
            background: var(--primary);
            color: white;
            border-radius: 8px;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .payment-link:hover {
            background: var(--secondary);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(66, 133, 244, 0.2);
        }

        .instruction-steps {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 25px;
        }

        .instruction-step {
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            border: 1px solid #e2e8f0;
            transition: transform 0.3s ease;
        }

        .instruction-step:hover {
            transform: translateY(-3px);
        }

        .step-number {
            background-color: var(--primary);
            color: white;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 15px;
            font-weight: bold;
            font-size: 16px;
        }

        .instruction-step div {
            color: var(--dark);
            font-weight: 500;
            line-height: 1.4;
        }

        .confirmation {
            display: none;
            text-align: center;
            padding: 30px;
            background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
            border-radius: 15px;
            margin-top: 25px;
            border-left: 4px solid var(--success);
        }

        .confirmation h3 {
            color: var(--success);
            margin-bottom: 20px;
            font-size: 1.8rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .confirmation h3 i {
            margin-right: 10px;
            font-size: 28px;
        }

        .confirmation p {
            margin-bottom: 20px;
            color: var(--dark);
            line-height: 1.6;
        }

        .order-details {
            text-align: left;
            background: white;
            padding: 25px;
            border-radius: 12px;
            margin: 25px 0;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        }

        .order-details h4 {
            margin-bottom: 20px;
            color: var(--primary);
            border-bottom: 2px solid #f1f5f9;
            padding-bottom: 15px;
            font-weight: 600;
            display: flex;
            align-items: center;
        }

        .order-details h4 i {
            margin-right: 10px;
        }

        .order-details p {
            margin-bottom: 12px;
            padding-left: 15px;
            border-left: 3px solid #f1f5f9;
            display: flex;
        }

        .order-details strong {
            min-width: 120px;
            color: var(--darker);
        }

        .order-details span {
            color: var(--gray);
        }

        .spinner {
            display: none;
            width: 40px;
            height: 40px;
            margin: 20px auto;
            border: 4px solid #f3f3f3;
            border-top: 4px solid var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        .admin-panel {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 2000;
            overflow: auto;
        }

        .admin-panel.active {
            display: block;
        }

        .admin-panel-content {
            background-color: white;
            margin: 2% auto;
            padding: 30px;
            border-radius: 20px;
            width: 95%;
            max-width: 1200px;
            position: relative;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.25);
            border: 1px solid #f1f5f9;
            animation: slideIn 0.3s ease;
        }

        .admin-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #e2e8f0;
        }

        .admin-title {
            font-size: 2rem;
            color: var(--darker);
            font-weight: 700;
            display: flex;
            align-items: center;
        }

        .admin-title i {
            margin-right: 15px;
            color: var(--primary);
            font-size: 28px;
        }

        .admin-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(66, 133, 244, 0.2);
            transition: transform 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .admin-tabs {
            display: flex;
            margin-bottom: 30px;
            border-bottom: 1px solid #e2e8f0;
            flex-wrap: wrap;
        }

        .admin-tab {
            flex: 1;
            min-width: 120px;
            text-align: center;
            padding: 15px;
            font-weight: 600;
            color: var(--gray);
            cursor: pointer;
            position: relative;
            transition: all 0.3s ease;
        }

        .admin-tab.active {
            color: var(--primary);
        }

        .admin-tab.active::after {
            content: '';
            position: absolute;
            bottom: -1px;
            left: 0;
            width: 100%;
            height: 2px;
            background: var(--primary);
        }

        .admin-content {
            display: none;
        }

        .admin-content.active {
            display: block;
        }

        .admin-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            margin-bottom: 30px;
        }

        .admin-table th {
            background: var(--darker);
            color: white;
            text-align: left;
            padding: 15px;
            font-weight: 600;
        }

        .admin-table td {
            padding: 15px;
            border-bottom: 1px solid #f1f5f9;
        }

        .admin-table tr:hover {
            background: #f8fafc;
        }

        .admin-actions {
            display: flex;
            gap: 10px;
        }

        .btn-small {
            padding: 8px 12px;
            font-size: 0.8rem;
            border-radius: 6px;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .btn-small i {
            margin-right: 4px;
        }

        .btn-edit {
            background: var(--warning);
        }

        .btn-delete {
            background: var(--error);
        }

        .btn-view {
            background: var(--success);
        }

        .btn-complete {
            background: var(--success);
        }

        .btn-reset {
            background: var(--primary);
            margin-left: 10px;
        }

        .data-management {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .export-import-container {
            background: #f8fafc;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 30px;
            border: 1px solid #e2e8f0;
        }

        .export-import-container h3 {
            margin-bottom: 15px;
            color: var(--darker);
            font-weight: 600;
        }

        .export-import-buttons {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .file-input-container {
            position: relative;
            overflow: hidden;
            display: inline-block;
        }

        .file-input-container input[type=file] {
            position: absolute;
            left: 0;
            top: 0;
            opacity: 0;
            cursor: pointer;
            width: 100%;
            height: 100%;
        }

        .data-status {
            margin-top: 15px;
            padding: 10px;
            border-radius: 8px;
            font-size: 14px;
        }

        .data-status.success {
            background: #d1fae5;
            color: #065f46;
            border-left: 4px solid var(--success);
        }

        .data-status.error {
            background: #fee2e2;
            color: #991b1b;
            border-left: 4px solid var(--error);
        }

        .user-info-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            border-left: 4px solid var(--primary);
        }

        .user-info-card h4 {
            margin-bottom: 15px;
            color: var(--darker);
            font-weight: 600;
        }

        .user-info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .user-info-item {
            display: flex;
            flex-direction: column;
        }

        .user-info-label {
            font-size: 0.8rem;
            color: var(--gray);
            margin-bottom: 5px;
        }

        .user-info-value {
            font-weight: 500;
            color: var(--darker);
        }

        .delete-confirmation {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 3000;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .delete-confirmation.active {
            opacity: 1;
            visibility: visible;
        }

        .delete-confirmation-content {
            background-color: white;
            padding: 30px;
            border-radius: 15px;
            width: 90%;
            max-width: 500px;
            text-align: center;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.25);
            transform: scale(0.8);
            transition: transform 0.3s ease;
        }

        .delete-confirmation.active .delete-confirmation-content {
            transform: scale(1);
        }

        .delete-confirmation h3 {
            margin-bottom: 20px;
            color: var(--darker);
            font-size: 1.5rem;
        }

        .delete-confirmation p {
            margin-bottom: 25px;
            color: var(--gray);
        }

        .delete-confirmation-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
        }

        .btn-cancel {
            background: #e2e8f0;
            color: var(--dark);
        }

        .btn-confirm {
            background: var(--error);
        }

        .order-details-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 3000;
            overflow: auto;
        }

        .order-details-modal.active {
            display: block;
        }

        .order-details-content {
            background-color: white;
            margin: 5% auto;
            padding: 30px;
            border-radius: 20px;
            width: 90%;
            max-width: 800px;
            position: relative;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.15);
        }

        .order-details-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid #e2e8f0;
        }

        .order-details-title {
            font-size: 1.8rem;
            color: var(--darker);
            font-weight: 700;
        }

        .order-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }

        .order-info-item {
            background: #f8fafc;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid var(--primary);
        }

        .order-info-label {
            font-size: 0.8rem;
            color: var(--gray);
            margin-bottom: 5px;
        }

        .order-info-value {
            font-weight: 600;
            color: var(--darker);
        }

        .account-details {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 3000;
            overflow: auto;
        }

        .account-details.active {
            display: block;
        }

        .account-details-content {
            background-color: white;
            margin: 5% auto;
            padding: 30px;
            border-radius: 20px;
            width: 90%;
            max-width: 800px;
            position: relative;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.15);
        }

        .account-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid #e2e8f0;
        }

        .account-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }

        .info-item {
            background: #f8fafc;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid var(--primary);
        }

        .info-label {
            font-size: 0.8rem;
            color: var(--gray);
            margin-bottom: 5px;
        }

        .info-value {
            font-weight: 600;
            color: var(--darker);
        }

        .orders-section {
            margin-top: 30px;
        }

        .orders-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }

        .orders-table th {
            background: var(--darker);
            color: white;
            text-align: left;
            padding: 12px;
            font-weight: 600;
        }

        .orders-table td {
            padding: 12px;
            border-bottom: 1px solid #f1f5f9;
        }

        .orders-table tr:hover {
            background: #f8fafc;
        }

        .admin-login {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            overflow: auto;
        }

        .admin-login.active {
            display: block;
        }

        .admin-login-content {
            background-color: white;
            margin: 10% auto;
            padding: 40px;
            border-radius: 20px;
            width: 90%;
            max-width: 500px;
            position: relative;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.15);
        }

        .admin-login-title {
            font-size: 1.8rem;
            margin-bottom: 25px;
            color: var(--darker);
            text-align: center;
        }

        .admin-form-group {
            margin-bottom: 20px;
        }

        .admin-form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--darker);
        }

        .admin-form-group input {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .admin-form-group input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(66, 133, 244, 0.1);
        }

        .admin-btn {
            width: 100%;
            padding: 14px;
            border: none;
            border-radius: 8px;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 16px;
        }

        .admin-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(66, 133, 244, 0.3);
        }

        .webhook-settings {
            background: #f8fafc;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 30px;
            border: 1px solid #e2e8f0;
        }

        .webhook-settings h3 {
            margin-bottom: 15px;
            color: var(--darker);
            font-weight: 600;
        }

        .webhook-form {
            display: flex;
            gap: 10px;
            align-items: flex-end;
        }

        .webhook-form-group {
            flex: 1;
            margin-bottom: 0;
        }

        .webhook-form-group label {
            margin-bottom: 5px;
            font-size: 14px;
        }

        .webhook-form-group input {
            padding: 10px;
            font-size: 14px;
        }

        .webhook-btn {
            padding: 10px 20px;
            border-radius: 8px;
            background: var(--primary);
            color: white;
            border: none;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .webhook-btn:hover {
            background: var(--secondary);
        }

        .webhook-status {
            margin-top: 10px;
            font-size: 14px;
            color: var(--gray);
        }

        .forgot-password-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            overflow: auto;
        }

        .forgot-password-modal.active {
            display: block;
        }

        .forgot-password-content {
            background-color: white;
            margin: 10% auto;
            padding: 40px;
            border-radius: 20px;
            width: 90%;
            max-width: 500px;
            position: relative;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.15);
        }

        .forgot-password-title {
            font-size: 1.8rem;
            margin-bottom: 25px;
            color: var(--darker);
            text-align: center;
        }

        .forgot-password-form {
            margin-bottom: 20px;
        }

        .forgot-password-form label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--darker);
        }

        .forgot-password-form input {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .forgot-password-form input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(66, 133, 244, 0.1);
        }

        .back-to-login {
            text-align: center;
            margin-top: 20px;
        }

        .back-to-login a {
            color: var(--primary);
            text-decoration: none;
            font-weight: 500;
        }

        .back-to-login a:hover {
            text-decoration: underline;
        }

        .admin-access {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: var(--darker);
            color: white;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: none !important; /* Hidden by default - force hidden */
            align-items: center;
            justify-content: center;
            font-size: 24px;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
            z-index: 999;
        }

        .admin-access.active {
            display: flex;
        }

        .admin-access:hover {
            transform: scale(1.1);
            background: var(--primary);
        }

        footer {
            background: var(--darker);
            color: white;
            padding: 60px 0 20px;
        }

        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 40px;
            margin-bottom: 50px;
        }

        .footer-section {
            margin-bottom: 30px;
        }

        .footer-section h3 {
            font-size: 1.4rem;
            margin-bottom: 25px;
            color: #ffdd40;
            font-weight: 600;
        }

        .footer-section p,
        .footer-section a {
            color: #cbd5e1;
            margin-bottom: 12px;
            display: block;
            text-decoration: none;
            transition: all 0.3s ease;
            line-height: 1.6;
        }

        .footer-section a:hover {
            color: #ffdd40;
            padding-left: 5px;
        }

        .social-icons {
            display: flex;
            gap: 15px;
            margin-top: 20px;
            justify-content: center;
        }

        .social-icons a {
            font-size: 20px;
            color: white;
            transition: all 0.3s ease;
            width: 45px;
            height: 45px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(255, 255, 255, 0.1);
        }

        .social-icons a:hover {
            background: var(--primary);
            transform: translateY(-3px);
        }

        .copyright {
            text-align: center;
            padding-top: 30px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            color: #94a3b8;
            font-size: 15px;
        }

        /* FAQ Section Styles - Horizontal Layout */
        .faq-section {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 25px;
            margin-top: 30px;
        }

        .faq-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .faq-item {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 20px;
            transition: transform 0.3s ease;
            height: 100%;
        }

        .faq-item:hover {
            transform: translateY(-5px);
            background: rgba(255, 255, 255, 0.15);
        }

        .faq-question {
            font-weight: 600;
            color: #ffdd40;
            margin-bottom: 10px;
            font-size: 1.1rem;
            display: flex;
            align-items: flex-start;
        }

        .faq-question i {
            margin-right: 10px;
            margin-top: 4px;
            color: var(--primary);
            flex-shrink: 0;
        }

        .faq-answer {
            color: #cbd5e1;
            line-height: 1.6;
        }

        .faq-answer-arabic {
            text-align: right;
            direction: rtl;
        }

        .faq-question-arabic {
            text-align: right;
            direction: rtl;
        }

        .faq-question-arabic i {
            margin-right: 0;
            margin-left: 10px;
        }

        /* Mobile Menu Toggle */
        .mobile-menu-toggle {
            display: none;
            background: none;
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
        }

        /* Mobile Responsive Styles */
        @media (max-width: 768px) {
            body {
                max-width: 100%;
            }

            .header-content {
                flex-direction: column;
                text-align: center;
            }

            .mobile-menu-toggle {
                display: block;
                position: absolute;
                top: 20px;
                right: 20px;
            }

            nav {
                width: 100%;
                display: none;
            }

            nav.active {
                display: block;
                margin-top: 20px;
            }

            nav ul {
                flex-direction: column;
                align-items: center;
            }

            nav ul li {
                margin: 10px 0;
            }

            .user-menu {
                margin-top: 15px;
                margin-left: 0;
                width: 100%;
                justify-content: center;
                flex-wrap: wrap;
            }

            .auth-dropdown {
                width: 90%;
                right: 5%;
            }

            .hero h1 {
                font-size: 2.5rem;
            }

            .hero p {
                font-size: 1.1rem;
            }

            .btn {
                padding: 14px 25px;
                font-size: 0.9rem;
            }

            .modal-content {
                width: 95%;
                margin: 10% auto;
                padding: 20px;
                max-height: 90vh;
                overflow-y: auto;
            }

            .payment-option {
                flex-direction: column;
                text-align: center;
            }

            .payment-icon {
                margin-right: 0;
                margin-bottom: 15px;
            }

            .instruction-steps {
                grid-template-columns: 1fr;
            }

            .steps {
                grid-template-columns: 1fr;
            }

            .product-actions {
                flex-direction: column;
            }

            .btn-product {
                padding: 14px 20px;
                font-size: 1rem;
            }

            .order-details-grid {
                grid-template-columns: 1fr;
            }

            .admin-table {
                font-size: 0.9rem;
            }

            .admin-actions {
                flex-direction: column;
            }

            .admin-stats {
                grid-template-columns: 1fr;
            }

            .account-info {
                grid-template-columns: 1fr;
            }

            .webhook-form {
                flex-direction: column;
                gap: 15px;
            }

            .data-management {
                flex-direction: column;
            }

            .settings-tabs {
                flex-direction: column;
            }

            .admin-tabs {
                flex-direction: column;
            }

            .footer-content {
                grid-template-columns: 1fr;
                text-align: center;
            }

            .product-grid {
                grid-template-columns: 1fr;
            }

            .feature-grid {
                grid-template-columns: 1fr;
            }

            .section-title h2 {
                font-size: 2rem;
            }

            .product-card {
                max-width: 400px;
                margin: 0 auto;
            }

            /* FAQ Mobile Styles */
            .faq-container {
                grid-template-columns: 1fr;
            }
        }

        /* Medium Screen Responsive Styles */
        @media (min-width: 769px) and (max-width: 1024px) {
            body {
                max-width: 100%;
            }

            .container {
                max-width: 90%;
            }

            .product-grid {
                grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            }

            .modal-content {
                width: 80%;
                max-width: 700px;
            }

            /* FAQ Medium Screen Styles */
            .faq-container {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        /* Large Screen Responsive Styles */
        @media (min-width: 1601px) {
            body {
                max-width: 1600px;
            }

            .container {
                max-width: 1400px;
            }

            /* FAQ Large Screen Styles */
            .faq-container {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        /* Fix for Blox Fruits product images */
        #bloxfruits-products .product-image,
        #bloxfruits-permanent-fruits .product-image {
            height: 250px;
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
            background-color: #f0f9ff;
        }

        /* Enhanced error styling */
        .error-box {
            background: #fee2e2;
            border: 1px solid #fecaca;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            color: #991b1b;
            box-shadow: 0 4px 6px rgba(239, 68, 68, 0.1);
        }

        .error-box h3 {
            color: #b91c1c;
            margin-bottom: 15px;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
        }

        .error-box h3 i {
            margin-right: 10px;
            font-size: 1.5rem;
        }

        .error-box pre {
            background: #f8fafc;
            padding: 15px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 15px 0;
            border: 1px solid #e2e8f0;
        }

        .error-box .btn {
            margin-top: 15px;
            background: var(--error);
        }

        .error-box .btn:hover {
            background: #dc2626;
        }

        .index-error-box {
            background: #fef3c7;
            border: 1px solid #fde68a;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            color: #92400e;
            box-shadow: 0 4px 6px rgba(245, 158, 11, 0.1);
        }

        .index-error-box h3 {
            color: #b45309;
            margin-bottom: 15px;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
        }

        .index-error-box h3 i {
            margin-right: 10px;
            font-size: 1.5rem;
        }

        .index-error-box .btn {
            margin-top: 15px;
            background: var(--warning);
        }

        .index-error-box .btn:hover {
            background: #d97706;
        }

        /* Fix for header auth button text color */
        .btn-outline.header-auth-btn {
            color: white !important;
        }

        /* Fix for logout button visibility */
        .user-menu .btn-outline {
            color: white !important;
            border: 2px solid rgba(255, 255, 255, 0.7) !important;
            background: rgba(255, 255, 255, 0.1) !important;
        }

        /* Admin panel logout button styling */
        .admin-header .btn-outline {
            color: #333 !important;
            border: 2px solid #007bff !important;
            background: #f8f9fa !important;
            font-weight: 600 !important;
        }

        .admin-header .btn-outline:hover {
            color: white !important;
            background: #007bff !important;
            border-color: #007bff !important;
        }

        .user-menu .btn-outline:hover {
            background: rgba(255, 255, 255, 0.2) !important;
        }

        /* Security info box */
        .security-info-box {
            background: #dbeafe;
            border: 1px solid #93c5fd;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            color: #1e40af;
            box-shadow: 0 4px 6px rgba(37, 99, 235, 0.1);
        }

        .security-info-box h3 {
            color: #1d4ed8;
            margin-bottom: 15px;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
        }

        .security-info-box h3 i {
            margin-right: 10px;
            font-size: 1.5rem;
        }

        .security-info-box pre {
            background: #f8fafc;
            padding: 15px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 15px 0;
            border: 1px solid #e2e8f0;
        }

        .security-info-box .btn {
            margin-top: 15px;
            background: var(--primary);
        }

        .security-info-box .btn:hover {
            background: var(--secondary);
        }


        /* Blox Fruits Toggle Button */
        .bloxfruits-toggle {
            display: flex;
            justify-content: center;
            margin-bottom: 30px;
            gap: 15px;
        }

        .toggle-btn {
            padding: 12px 25px;
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 50px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            color: var(--gray);
            position: relative;
            overflow: hidden;
            z-index: 1;
        }

        .toggle-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 0;
            height: 100%;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            transition: width 0.3s ease;
            z-index: -1;
        }

        .toggle-btn.active {
            color: white;
            border-color: transparent;
            box-shadow: 0 5px 15px rgba(66, 133, 244, 0.2);
        }

        .toggle-btn.active::before {
            width: 100%;
        }

        .toggle-btn:hover:not(.active) {
            border-color: var(--primary);
            color: var(--primary);
        }

        /* Payment Upload Section */
        .payment-upload-section {
            display: none;
            margin-top: 25px;
        }

        .payment-upload-section h3 {
            margin-bottom: 20px;
            color: var(--darker);
            font-weight: 600;
            display: flex;
            align-items: center;
        }

        .payment-upload-section h3 i {
            margin-right: 10px;
            color: var(--primary);
        }

        .payment-upload-instructions {
            background: white;
            padding: 25px;
            border-radius: 15px;
            margin: 25px 0;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            border: 1px solid #e2e8f0;
            text-align: center;
        }

        .payment-upload-instructions h4 {
            margin-bottom: 20px;
            color: var(--primary);
            font-size: 1.3rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .payment-upload-instructions h4 i {
            margin-right: 10px;
        }

        .payment-upload-instructions p {
            margin-bottom: 20px;
            font-size: 1.1rem;
            color: var(--dark);
        }

        .upload-area {
            border: 2px dashed #e2e8f0;
            border-radius: 12px;
            padding: 30px;
            text-align: center;
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
            margin-bottom: 20px;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .upload-area:hover {
            border-color: var(--primary);
            background: rgba(66, 133, 244, 0.05);
        }

        .upload-area i {
            font-size: 48px;
            color: var(--primary);
            margin-bottom: 15px;
        }

        .upload-area p {
            margin-bottom: 20px;
            color: var(--gray);
        }

        .upload-btn {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 16px;
        }

        .upload-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(66, 133, 244, 0.3);
        }

        .upload-preview {
            margin-top: 20px;
            text-align: center;
            display: none;
        }

        .upload-preview img {
            max-width: 100%;
            max-height: 300px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            margin-bottom: 15px;
        }

        .upload-preview p {
            color: var(--success);
            font-weight: 500;
        }

        .file-input {
            display: none;
        }

        .submit-upload-btn {
            width: 100%;
            padding: 16px;
            border: none;
            border-radius: 8px;
            background: linear-gradient(135deg, var(--success) 0%, #34d399 100%);
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 16px;
            margin-top: 20px;
            display: none;
        }

        .submit-upload-btn.active {
            display: block;
        }

        .submit-upload-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(34, 197, 94, 0.3);
        }

        .submit-upload-btn:disabled {
            background: var(--gray);
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        /* Mobile file input fix */
        .mobile-file-input {
            position: relative;
            overflow: hidden;
            display: inline-block;
            width: 100%;
        }

        .mobile-file-input input[type=file] {
            position: absolute;
            left: 0;
            top: 0;
            opacity: 0;
            width: 100%;
            height: 100%;
            cursor: pointer;
        }

        /* Image fallback styling */
        .product-image::after {
            content: attr(data-fallback-text);
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #333;
            font-weight: bold;
            text-align: center;
            opacity: 0;
            transition: opacity 0.3s ease;
            pointer-events: none;
            font-size: 1.2rem;
        }

        .product-image:not([style*="background-image"])::after,
        .product-image[style*="background-image: none"]::after,
        .product-image[style*="background-image: url('')"]::after {
            opacity: 1;
        }

        /* Arabic Warning Badge */
        .arabic-warning-badge {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, var(--discord) 0%, #7289da 100%);
            color: white;
            padding: 12px 25px;
            border-radius: 50px;
            margin: 20px auto 0;
            max-width: 800px;
            box-shadow: 0 4px 12px rgba(88, 101, 242, 0.3);
            animation: fadeInUp 0.8s ease 0.4s forwards;
            opacity: 0;
            font-weight: 600;
            font-size: 1rem;
            line-height: 1.4;
            text-align: center;
            position: relative;
            overflow: hidden;
            z-index: 1;
        }

        .arabic-warning-badge::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.1);
            transform: translateX(-100%);
            transition: transform 0.5s ease;
            z-index: -1;
        }

        .arabic-warning-badge:hover::before {
            transform: translateX(0);
        }

        .arabic-warning-badge:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(88, 101, 242, 0.4);
        }

        .arabic-warning-badge i {
            margin-right: 10px;
            font-size: 1.2rem;
        }

        /* Arabic Warning Section for Robux Products */
        .arabic-warning-section {
            text-align: center;
            margin: 30px 0;
            padding: 20px;
            border-radius: 12px;
            background: linear-gradient(135deg, rgba(255, 245, 245, 0.8) 0%, rgba(255, 235, 235, 0.8) 100%);
            border: 1px solid rgba(239, 68, 68, 0.2);
        }

        .arabic-warning-text {
            color: var(--error);
            font-weight: bold;
            font-size: 1.1rem;
            margin-bottom: 10px;
            text-align: center;
        }

        .english-warning-text {
            color: var(--gray);
            font-style: italic;
            font-size: 0.9rem;
            text-align: center;
        }

        /* Order Platform Options */
        .order-platform-options {
            margin-top: 20px;
            text-align: center;
        }

        .order-platform-options h3 {
            color: var(--darker);
            margin-bottom: 20px;
            font-size: 1.2rem;
            font-weight: 600;
        }

        .platform-buttons {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 15px;
        }

        .platform-button {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 180px;
        }

        .platform-button:hover {
            border-color: var(--primary);
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }

        .platform-button i {
            font-size: 36px;
            margin-bottom: 15px;
            color: var(--primary);
        }

        .platform-button.facebook i {
            color: var(--facebook);
        }

        .platform-button.discord i {
            color: var(--discord);
        }

        .platform-button span {
            font-weight: 600;
            color: var(--darker);
        }

        .platform-description {
            margin-top: 20px;
            color: var(--gray);
            font-style: italic;
            text-align: center;
        }

        /* MM2 Product Styles */
        .mm2-section {
            padding: 60px 0;
            background: white;
        }

        .mm2-product-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 30px;
            margin-top: 40px;
        }

        .mm2-product-card {
            background: white;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: var(--card-shadow);
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            border: 1px solid #f1f5f9;
            position: relative;
            height: 100%;
        }

        .mm2-product-card:hover {
            transform: var(--hover-transform);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.12);
        }

        .mm2-product-image {
            height: 200px;
            background: linear-gradient(45deg, var(--primary) 0%, var(--secondary) 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 70px;
            position: relative;
            overflow: hidden;
        }

        .mm2-product-content {
            padding: 25px;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
        }

        .mm2-product-title {
            font-size: 1.4rem;
            margin-bottom: 12px;
            color: var(--darker);
            font-weight: 600;
        }

        .mm2-product-price {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
        }

        .mm2-product-price::before {
            content: "EGP";
            font-size: 1rem;
            margin-right: 5px;
            color: var(--gray);
            font-weight: 500;
        }

        .mm2-btn-buy {
            flex: 1;
            text-align: center;
            padding: 12px 20px;
            border-radius: 10px;
            font-weight: 600;
            transition: all 0.3s ease;
            cursor: pointer;
            border: none;
            color: white;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            box-shadow: 0 4px 10px rgba(66, 133, 244, 0.25);
        }

        .mm2-btn-buy:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(66, 133, 244, 0.35);
        }

        .tier-badge {
            position: absolute;
            top: 15px;
            right: 15px;
            color: white;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            z-index: 2;
        }

        .tier-1 {
            background: var(--success);
        }

        .tier-2 {
            background: var(--warning);
        }

        .tier-3 {
            background: var(--error);
        }

        .search-container {
            display: flex;
            justify-content: center;
            margin-bottom: 30px;
        }

        .search-input {
            width: 100%;
            max-width: 500px;
            padding: 15px 20px;
            border: 2px solid #e2e8f0;
            border-radius: 50px;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .search-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(66, 133, 244, 0.1);
        }
    </style>
</head>

<body>
    <div class="discord-banner" id="discordBanner">
        <i class="fab fa-discord"></i> Need help? Join our <a href="https://discord.gg/pCYvMsmScW"
            target="_blank">Discord Support Server</a>
    </div>
    <div class="facebook-banner" id="facebookBanner">
        <i class="fab fa-facebook-f"></i> Visit our <a href="https://www.facebook.com/profile.php?id=61581826985292"
            target="_blank">Facebook Page</a>
    </div>
    <div class="whatsapp-banner" id="whatsappBanner">
    <i class="fab fa-whatsapp"></i> Join our 
    <a href="https://chat.whatsapp.com/FLQutpqrmuMH18mUEgXFQt?mode=hqrt1" target="_blank">WhatsApp Community</a>
</div>

    <header>
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <i class="fas fa-gamepad"></i>Egypt<span>GameStore</span>
                </div>
                <button class="mobile-menu-toggle" id="mobile-menu-toggle">
                    <i class="fas fa-bars"></i>
                </button>
                <nav id="main-nav">
                    <ul>
                        <li><a href="#home">Home</a></li>
                        <li><a href="#products">Products</a></li>
                        <li><a href="#how-it-works">How It Works</a></li>
                        <li><a href="#contact">Contact</a></li>
                    </ul>
                </nav>
                <div class="user-menu" id="userMenu">
                    <!-- This will be populated by JavaScript -->
                </div>
            </div>
        </div>
    </header>
    <section class="hero" id="home">
        <div class="container">
            <h1>Premium Robux &amp; Game Items</h1>
            <p>Buy Cheap Roblox Products : Robux And Murder Mystery 2 And BloxFruit and Steal A BrainRot Using  And  In Egypt</p>
            <div class="hero-buttons">
                <a class="btn" href="#products"><i class="fas fa-shopping-cart"></i> Shop Now</a>

          </div>
            <div class="arabic-warning-badge">
                <i class="fas fa-exclamation-triangle"></i>
                ادخل سيرفر الديسكورد او صفحه الفيس بوك علشان تبدا الاوردر و تشترك في مسابقات كتير ببلاش مش لازم تعمل اكونت هنا
            </div>
        </div>
    </section>


    <section class="products" id="products">
        <div class="container">
          <div class="section-title">
            <h2>Our Products</h2>
            <p>Choose from our selection of gaming items and currencies</p>
            <p>اشتري روبكس من خلال انستا باي و فودافون كاش باقل سعر</p>
          </div>
      
          <!-- Category tabs -->
          <div class="category-tabs">
            <div class="category-tab active" data-category="robux">Robux</div>
            <div class="category-tab" data-category="bloxfruits">Blox Fruits</div>
            <div class="category-tab" data-category="mm2">Murder Mystery 2</div>
            <div class="category-tab" data-category="garden">Steal A BrainRot</div>
          </div>
      
          <!-- Robux notice (shown only on Robux tab) -->
          <div class="arabic-warning-section" id="robux-warning">
            <div class="arabic-warning-text">
             ادخل سيرفر الديسكورد او صفحه الفيس علشان تبدا الاوردر الصفحه معموله لعرض المنتجات و الاسعار
            </div>
            <div class="english-warning-text">
              Join Discord Server Or FaceBook Page To Start Your Order Site Is For Advertising Products And Prices
            </div>
          </div>
      
          <!-- ============ ROBUX ============ -->
          <div class="product-grid" id="robux-products">
            <!-- Products will be loaded from Firebase -->
          </div>
          <!-- /ROBUX -->
      
          <!-- ============ BLOX FRUITS (with inner toggle) ============ -->
          <div id="bloxfruits-container" style="display:none">
            <div class="bloxfruits-toggle">
              <button class="toggle-btn active" id="gamepasses-btn" onclick="openSocialOrderModal()">Gamepasses</button>
              <button class="toggle-btn" id="permanent-fruits-btn" onclick="openSocialOrderModal()">Permanent Fruit Shop</button>
            </div>
      
            <!-- Gamepasses -->
            <div class="product-grid" id="bloxfruits-products">
              <!-- Products will be loaded from Firebase -->
              <div class="product-card">
                <div class="product-image" style="background-image:url('https://tr.rbxcdn.com/180DAY-acf0a1f1983c30f7ccded0c756845f36/150/150/Image/Webp/noFilter');">
                  <div class="product-badge">Popular</div>
                </div>
                <div class="product-content">
                  <h3 class="product-title">2x Mastery</h3>
                  <p class="product-desc">Double mastery gain in Blox Fruits</p>
                  <div class="product-price">155</div>
                  <div class="product-actions">
                    <button class="btn-product btn-buy" onclick="openSocialOrderModal()">
                      <i class="fas fa-shopping-cart"></i> Buy Now
                    </button>
                  </div>
                </div>
              </div>
      
              <div class="product-card">
                <div class="product-image" style="background-image:url('https://tr.rbxcdn.com/180DAY-63a5bf6ea7e029c50bd82024ac2beae4/150/150/Image/Webp/noFilter');"></div>
                <div class="product-content">
                  <h3 class="product-title">2x Money</h3>
                  <p class="product-desc">Double money gain in Blox Fruits</p>
                  <div class="product-price">155</div>
                  <div class="product-actions">
                    <button class="btn-product btn-buy" onclick="openSocialOrderModal()">
                      <i class="fas fa-shopping-cart"></i> Buy Now
                    </button>
                  </div>
                </div>
              </div>
      
              <div class="product-card">
                <div class="product-image" style="background-image:url('https://tr.rbxcdn.com/180DAY-021c08aab80ee2cbdba77de1fd128a7a/150/150/Image/Webp/noFilter');"></div>
                <div class="product-content">
                  <h3 class="product-title">Fast Boats</h3>
                  <p class="product-desc">Get fast boats for quick travel</p>
                  <div class="product-price">120</div>
                  <div class="product-actions">
                    <button class="btn-product btn-buy" onclick="openSocialOrderModal()">
                      <i class="fas fa-shopping-cart"></i> Buy Now
                    </button>
                  </div>
                </div>
              </div>
      
              <div class="product-card">
                <div class="product-image" style="background-image:url('https://tr.rbxcdn.com/180DAY-ff811a03ac90fe123e7bb1789bf188f0/150/150/Image/Webp/noFilter');"></div>
                <div class="product-content">
                  <h3 class="product-title">2x Boss Drops</h3>
                  <p class="product-desc">Double drops from bosses</p>
                  <div class="product-price">120</div>
                  <div class="product-actions">
                    <button class="btn-product btn-buy" onclick="openSocialOrderModal()">
                      <i class="fas fa-shopping-cart"></i> Buy Now
                    </button>
                  </div>
                </div>
              </div>
      
              <div class="product-card">
                <div class="product-image" style="background-image:url('https://tr.rbxcdn.com/180DAY-d11805051612e36ad5b32c0b78459680/150/150/Image/Webp/noFilter');">
                  <div class="product-badge">Popular</div>
                </div>
                <div class="product-content">
                  <h3 class="product-title">Dark Blade</h3>
                  <p class="product-desc">Powerful Dark Blade weapon</p>
                  <div class="product-price">410</div>
                  <div class="product-actions">
                    <button class="btn-product btn-buy" onclick="openSocialOrderModal()">
                      <i class="fas fa-shopping-cart"></i> Buy Now
                    </button>
                  </div>
                </div>
              </div>
      
              <div class="product-card">
                <div class="product-image" style="background-image:url('https://tr.rbxcdn.com/180DAY-d90e7a4dc5a82f0d8b0d22951c99bd63/150/150/Image/Webp/noFilter');">
                  <div class="product-badge">Premium</div>
                </div>
                <div class="product-content">
                  <h3 class="product-title">Fruit Notifier</h3>
                  <p class="product-desc">Get notified when fruits spawn</p>
                  <div class="product-price">940</div>
                  <div class="product-actions">
                    <button class="btn-product btn-buy" onclick="openSocialOrderModal()">
                      <i class="fas fa-shopping-cart"></i> Buy Now
                    </button>
                  </div>
                </div>
              </div>
            </div>
      
            <!-- Permanent Fruits -->
            <div class="product-grid" id="bloxfruits-permanent-fruits" style="display:none">
              <div class="product-card">
                <div class="product-image" data-fallback-text="Dragon Fruit" style="background-image:url('https://z-cdn-media.chatglm.cn/files/278b9668-95cb-4d08-9b81-071ac1c2b209_dragon.png?auth_key=1790150681-688b6327b39049a69d468fa96e2df565-0-f303a7012092b1ae0f6449215a8cdfbe');">
                  <div class="product-badge">Premium</div>
                </div>
                <div class="product-content">
                  <h3 class="product-title">Dragon Fruit</h3>
                  <p class="product-desc">Permanent Dragon Fruit for Blox Fruits</p>
                  <div class="product-price">1750</div>
                  <div class="product-actions">
                    <button class="btn-product btn-buy" onclick="openSocialOrderModal()">
                      <i class="fas fa-shopping-cart"></i> Buy Now
                    </button>
                  </div>
                </div>
              </div>
      
              <div class="product-card">
                <div class="product-image" data-fallback-text="Kitsune Fruit" style="background-image:url('https://z-cdn-media.chatglm.cn/files/90b68a3b-60ce-43c2-ac98-3c693c5a2c17_Kitsune.png?auth_key=1790150681-384b650b46e64c78b9db55bdf92f57d7-0-fa9dc4989fae9b9c722cd96ba6f71ff8');"></div>
                <div class="product-content">
                  <h3 class="product-title">Kitsune Fruit</h3>
                  <p class="product-desc">Permanent Kitsune Fruit for Blox Fruits</p>
                  <div class="product-price">1400</div>
                  <div class="product-actions">
                    <button class="btn-product btn-buy" onclick="openSocialOrderModal()">
                      <i class="fas fa-shopping-cart"></i> Buy Now
                    </button>
                  </div>
                </div>
              </div>
      
              <div class="product-card">
                <div class="product-image" data-fallback-text="Yeti Fruit" style="background-image:url('https://i.ibb.co/TDcXnyf2/Yeti.webp');"></div>
                <div class="product-content">
                  <h3 class="product-title">Yeti Fruit</h3>
                  <p class="product-desc">Permanent Yeti Fruit for Blox Fruits</p>
                  <div class="product-price">1050</div>
                  <div class="product-actions">
                    <button class="btn-product btn-buy" onclick="openSocialOrderModal()">
                      <i class="fas fa-shopping-cart"></i> Buy Now
                    </button>
                  </div>
                </div>
              </div>
      
              <div class="product-card">
                <div class="product-image" data-fallback-text="Leopard Fruit" style="background-image:url('https://z-cdn-media.chatglm.cn/files/793f75ff-928b-41c6-848d-27a0d5e01058_Leopard.png?auth_key=1790150681-ec87fcd67bf5471f837be82156c3b057-0-cae762c2f8426586be874ff4b6cd56d0');"></div>
                <div class="product-content">
                  <h3 class="product-title">Leopard Fruit</h3>
                  <p class="product-desc">Permanent Leopard Fruit for Blox Fruits</p>
                  <div class="product-price">1050</div>
                  <div class="product-actions">
                    <button class="btn-product btn-buy" onclick="openSocialOrderModal()">
                      <i class="fas fa-shopping-cart"></i> Buy Now
                    </button>
                  </div>
                </div>
              </div>
      
              <!-- (… keep the rest of your Permanent Fruits cards exactly as they are, but with 'bloxfruits' in openOrderModal …) -->
      
              <div class="product-card">
                <div class="product-image" data-fallback-text="Spider Fruit" style="background-image:url('https://i.ibb.co/cK8Vnk5c/Spider.webp');"></div>
                <div class="product-content">
                  <h3 class="product-title">Spider Fruit</h3>
                  <p class="product-desc">Permanent Spider Fruit for Blox Fruits</p>
                  <div class="product-price">630</div>
                  <div class="product-actions">
                    <button class="btn-product btn-buy" onclick="openSocialOrderModal()">
                      <i class="fas fa-shopping-cart"></i> Buy Now
                    </button>
                  </div>
                </div>
              </div>
            </div>
            <!-- /Permanent Fruits -->
          </div>
          <!-- /BLOX FRUITS -->
      
          <!-- ============ MURDER MYSTERY 2 ============ -->
          <div class="mm2-section" id="mm2-products" style="display:none">
            <div class="container">
              <div class="section-title">
                <h2>Murder Mystery 2 Godlies</h2>
                <p>أفضل أسعار لجميع أنواع Godlies في لعبة Murder Mystery 2</p>
              </div>
      
              <div class="search-container">
                <input type="text" id="mm2-search" class="search-input" placeholder="Search Bar Godly...">
              </div>
      
              <div class="mm2-product-grid" id="mm2-product-grid">
      
                <!-- (ALL your MM2 cards stay here; I only fixed the openOrderModal 3rd argument to 'mm2') -->
      
                <div class="mm2-product-card">
                  <div class="mm2-product-image"><i class="fas fa-image"></i></div>
                  <div class="mm2-product-content">
                    <span class="tier-badge tier-3">Tier 3</span>
                    <h3 class="mm2-product-title">Traveler's Gun</h3>
                    <div class="mm2-product-price">xxx</div>
                    <button class="mm2-btn-buy" onclick="openSocialOrderModal()">Buy Now</button>
                  </div>
                </div>
      
                <div class="mm2-product-card">
                  <div class="mm2-product-image"><i class="fas fa-image"></i></div>
                  <div class="mm2-product-content">
                    <span class="tier-badge tier-3">Tier 3</span>
                    <h3 class="mm2-product-title">Evergun</h3>
                    <div class="mm2-product-price">xxx</div>
                    <button class="mm2-btn-buy" onclick="openSocialOrderModal()">Buy Now</button>
                  </div>
                </div>
      
                <!-- (… keep the rest of your MM2 list exactly as-is, all calling 'mm2' …) -->
      
                <div class="mm2-product-card">
                  <div class="mm2-product-image"><i class="fas fa-image"></i></div>
                  <div class="mm2-product-content">
                    <span class="tier-badge tier-1">Tier 1</span>
                    <h3 class="mm2-product-title">Snowflake</h3>
                    <div class="mm2-product-price">xxx</div>
                    <button class="mm2-btn-buy" onclick="openSocialOrderModal()">Buy Now</button>
                  </div>
                </div>
      
              </div>
            </div>
          </div>
          <!-- /MM2 -->
      
          <!-- ============ GROW A GARDEN ============ -->
          <div class="product-grid" id="garden-products" style="display:none">
            <div class="product-card">
              <div class="product-image"><i class="fas fa-seedling"></i></div>
              <div class="product-content">
                <h3 class="product-title">Coming Soon</h3>
                <p class="product-desc">Grow a Garden items will be available soon. Stay tuned!</p>
                <div class="product-actions">
                  <button class="btn-product btn-buy" disabled>
                    <i class="fas fa-clock"></i> Coming Soon
                  </button>
                </div>
              </div>
            </div>
          </div>
          <!-- /GARDEN -->
        </div>
      </section>
      


    <!-- User Settings Modal -->
    <div class="user-settings-modal" id="user-settings-modal">
        <div class="user-settings-content">
            <div class="settings-header">
                <h2 class="settings-title">User Settings</h2>
                <button class="close" onclick="openSocialOrderModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="settings-tabs">
                <div class="settings-tab active" onclick="openSocialOrderModal()">Profile</div>
                <div class="settings-tab" onclick="openSocialOrderModal()">Security</div>
            </div>
            <form class="settings-form active" id="profileForm" onsubmit="return false;">
                <div class="form-group">
                    <label>Full Name</label>
                    <input id="settingsName" placeholder="Your full name" type="text" />
                </div>
                <div class="form-group">
                    <label>Email Address</label>
                    <input id="settingsEmail" placeholder="Your email address" type="email" />
                </div>
                <div class="form-group">
                    <label>Phone Number</label>
                    <input id="settingsPhone" placeholder="Your phone number" type="tel" />
                </div>
                <button class="btn-save" onclick="openSocialOrderModal()" type="button">Save Changes</button>
            </form>
            <form class="settings-form" id="securityForm" onsubmit="return false;">
                <div class="form-group">
                    <label>Current Password</label>
                    <input id="currentPassword" placeholder="Enter your current password" type="password" />
                </div>
                <div class="form-group">
                    <label>New Password</label>
                    <input id="newPassword" placeholder="Enter your new password" type="password" />
                </div>
                <div class="form-group">
                    <label>Confirm New Password</label>
                    <input id="confirmNewPassword" placeholder="Confirm your new password" type="password" />
                </div>
                <button class="btn-save" onclick="openSocialOrderModal()" type="button">Change Password</button>
            </form>
        </div>
    </div>
    <section class="features">
        <div class="container">
            <div class="section-title">
                <h2>EgyptGameShop</h2>
                <p>We provide the best service for Egyptian gamers</p>
            </div>
            <div class="feature-grid">
                <div class="feature-card">
                    <div class="feature-icon">💳</div>
                    <h3>Local Payment Methods</h3>
                    <p>Pay easily with  or . No need for international credit cards.</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">⚡</div>
                    <h3>Instant Delivery</h3>
                    <p>Receive your items within minutes after payment confirmation. No waiting required.</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">🛡️</div>
                    <h3>Secure Transactions</h3>
                    <p>All transactions are protected with secure verification processes for your safety.</p>
                </div>
            </div>
        </div>
    </section>
    <section class="how-it-works" id="how-it-works">
 <div class="container">
            <div class="section-title">
                <h2>ازاي تبدأ الاوردر و الخطوات</h2>
                <p>لازم تقرا القواعد في الديسكورد او صفحه الفيس علشان تعرف كل التفاصيل كمام و ازاي بتستلم</p>
            </div>
            <div class="steps">
     <div class="step">
<div class="step-number">4</div>
                    <h3>هنبعتلك الرقم اللي هتحول عليه</h3>
                    <p>لما تبعت هيتم التاكد من الدفع في نفس الوقت</p>
                </div>
                <div class="step">
                    <div class="step-number">3</div>
                    <h3>ابعت طريقه الدفع اللي عايز تستخدمها</h3>
                    <p>انستا باي او فودافون كاش</p>
                </div>
                <div class="step">
                    <div class="step-number">2</div>
                    <h3>ابعت اسم المنتج اللي انت عايزه </h3>
                    <p>مثلا : 5000 روبكس</p>
                </div>
                <div class="step">
                    <div class="step-number">1</div>
                    <h3>ادخل سيرفر الديسكورد او صفحه الفيس او الواتساب</h3>
                    <p>لو علي الديسكورد افتح تيكت اوردر و لو علي الفيس او الواتساب ابعت علي رسايل الصفحه و هيتم الرد عليك</p>
                </div>
                <div class="step">
                    <div class="step-number">5</div>
                    <h3>استلم الاوردر في اقل من 10 دقائق</h3>
                    <p>تريقه التسليم لكل منتج متوضحه بالتفصيل في سيرفر الديسكورد و علي صفحه الفيس</p>
                </div>
            </div>
        </div>
    </section>
    <div class="modal" id="orderModal">
        <div class="modal-content">
            <span class="close" onclick="openSocialOrderModal()">×</span>
            <h2>Place Your Order</h2>
            <div class="order-summary">
                <h3><i class="fas fa-receipt"></i> Order Summary</h3>
                <div class="order-item-summary">
                    <span class="order-item-name" id="modal-item-name">Product Name</span>
                    <span class="order-item-price" id="modal-item-price">0 EGP</span>
                </div>
                <div class="product-tax-note" id="taxNote">WE DO NOT COVER ROBLOX FEES</div>
                <div class="order-total">
                    <span>Total:</span>
                    <span id="modal-total-price">0 EGP</span>
                </div>
            </div>
            <form id="orderForm" onsubmit="return false;">
                <div class="form-group" id="usernameGroup">
                    <label id="usernameLabel"><i class="fas fa-user"></i> Your Roblox Username *</label>
                    <input id="username" name="username" placeholder="Enter your Roblox username" required=""
                        type="text" />
                </div>
                <div class="form-group">
                    <label><i class="fas fa-envelope"></i> Your Email *</label>
                    <input id="email" name="email" placeholder="your@email.com" required="" type="email" />
                </div>
                <div class="form-group">
                    <label><i class="fas fa-phone"></i> Your WhatsApp Number *</label>
                    <input id="phone" name="phone" pattern="01[0-9]{9}" placeholder="01XXXXXXXXX" required=""
                        type="tel" />
                </div>
                <div class="form-group" id="gamepassGroup">
                    <label><i class="fas fa-link"></i> Gamepass Link *</label>
                    <input id="gamepassLinkInput" name="gamepassLink" placeholder="Paste your gamepass link here"
                        required="" type="url" />
                    <div class="form-note">MAKE SURE THE PRICE = TO THE ORDER YOU MADE</div>
                </div>
                <button class="btn" onclick="openSocialOrderModal()" type="button"><i class="fas fa-arrow-right"></i>
                    Continue to Payment</button>
            </form>
            
                    <div class="payment-option">
                        <i class="fa-brands fa-discord" style="color:#5865F2;font-size:32px;margin-right:15px;"></i>
                        <div class="payment-details">
                            <h4>Join Discord Server</h4>
                            <p>Join the Discord server to make the purchase and learn more details</p>
                            <p>ادخل سيرفر الديسكورد علشان تعمل أوردر و تعرف التفاصيل</p>
                            <a class="payment-link" href="https://discord.com/invite/pCYvMsmScW" target="_blank">Join
                                Discord</a>
                        </div>
                    </div>
                </div>
                <div id="paymentDetails">
                    <div class="payment-instructions">
                        <h4 id="payment-method-title"><i class="fas fa-info-circle"></i> Payment Instructions</h4>
                        <p>Please send the following amount:</p>
                        <div class="payment-amount" id="paymentAmount">0 EGP</div>
                        <!--  Details -->
                        <div id="-details" style="display: none;">
                            <div class="payment-email">amlelsaid2024@</div>
                            
                            </div>
                            <a class="payment-link" href="https://ipn.eg/S/amlelsaid2024//70vZoa"
                                target="_blank">
                                <i class="fas fa-external-link-alt"></i> Open  Payment Link
                            </a>
                        </div>
                        <!--  Details -->
                        <div id="vodafone-details" style="display: none;">
                            
                            </div>
                            <a class="payment-link" href="http://vf.eg/vfcash?id=mt&amp;qrId=ggZjEC" target="_blank">
                                <i class="fas fa-external-link-alt"></i> Open  Payment Link
                            </a>
                        </div>
                        <p>Include your Roblox username in the payment message/note.</p>
                        <div class="instruction-steps">
                            <div class="instruction-step">
                                <div class="step-number">1</div>
                                <div>Open your payment app ( or )</div>
                            </div>
                            <div class="instruction-step">
                                <div class="step-number">2</div>
                                <div>Send <span id="instruction-amount">0 EGP</span> using the details above</div>
                            </div>
                            <div class="instruction-step">
                                <div class="step-number">3</div>
                                <div>Include your Roblox username in the payment message/note</div>
                            </div>
                            <div class="instruction-step">
                                <div class="step-number">4</div>
                                <div>Click "I've Made the Payment" below</div>
                            </div>
                        </div>
                    </div>
                    <div class="spinner" id="submitSpinner"></div>
                    <button class="btn" id="submitOrderBtn" onclick="openSocialOrderModal()"
                        style="margin-top: 15px; width: 100%; padding: 16px;" type="button">
                        <i class="fas fa-check-circle"></i> I've Made the Payment
                    </button>
                </div>
            </div>
            <div class="payment-upload-section" id="paymentUploadSection">
                <h3><i class="fas fa-upload"></i> Upload Payment Receipt</h3>
                <div class="payment-upload-instructions">
                    <h4 id="upload-title"><i class="fas fa-camera"></i> Upload Picture Of The Payment</h4>
                    <p id="upload-message">Please upload a clear picture of your payment confirmation to verify your
                        order.</p>
                    <div class="mobile-file-input">
                        <div class="upload-area" onclick="openSocialOrderModal()">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <p>Click to upload or drag and drop</p>
                            <p>PNG, JPG, GIF up to 10MB</p>
                        </div>
                        <input accept="image/*" class="file-input" id="paymentReceipt"
                            onchange="handlePaymentReceiptUpload(event)" type="file" />
                    </div>
                    <div class="upload-preview" id="uploadPreview">
                        <img alt="Payment Receipt" id="previewImage" src="" />
                        <p>Receipt uploaded successfully</p>
                    </div>
                    <div class="spinner" id="uploadSpinner"></div>
                    <button class="submit-upload-btn" id="submitUploadBtn" onclick="openSocialOrderModal()"
                        type="button">
                        <i class="fas fa-check-circle"></i> Submit Order
                    </button>
                </div>
            </div>
            <div class="confirmation" id="orderConfirmation">
                <h3><i class="fas fa-check-circle"></i> Order Received Successfully!</h3>
                <p>Thank you for your order. We will verify your payment and deliver your items within <strong>24
                        hours</strong>.</p>
                <p style="font-weight: bold; color: var(--error);">Remember to manually check your bank account to
                    confirm the payment was received.</p>
                <div class="order-details">
                    <h4><i class="fas fa-receipt"></i> Order Details:</h4>
                    <p><strong>Product:</strong> <span id="conf-product"></span></p>
                    <p><strong>Price:</strong> <span id="conf-price"></span></p>
                    <p><strong>Username:</strong> <span id="conf-username"></span></p>
                    <p><strong>Email:</strong> <span id="conf-email"></span></p>
                    <p><strong>WhatsApp:</strong> <span id="conf-phone"></span></p>
                    <p><strong>Gamepass:</strong> <span id="conf-gamepass"></span></p>
                </div>
                <p><strong>If you don't receive your items within 24 hours, contact us on Discord:</strong></p>
                <p><a href="https://discord.gg/pCYvMsmScW" style="color: var(--discord); font-weight: bold;"
                        target="_blank"><i class="fab fa-discord"></i> https://discord.gg/pCYvMsmScW</a></p>
                <button class="btn" onclick="openSocialOrderModal()"><i class="fas fa-times"></i> Close</button>
            </div>
        </div>
    </div>
    <section class="payment-methods">
        <div class="container">
            <div class="section-title">
                <h2>Accepted Payment Methods</h2>
                <p>We accept popular Egyptian payment options for your convenience</p>
            </div>
            <div class="payment-icons">
                <div class="payment-icon-large">
                    <i class="fas fa-money-bill-wave"></i>
                    <span></span>
                </div>
                <div class="payment-icon-large">
                    <i class="fas fa-mobile-alt"></i>
                    <span></span>
                </div>
            </div>
        </div>
    </section>
    <!-- Admin Panel Modal -->
    <div class="admin-panel" id="adminPanel">
        <div class="admin-panel-content">
            <div class="admin-header">
                <h2 class="admin-title"><i class="fas fa-user-shield"></i> Admin Panel</h2>
                <div>
                    <button class="btn btn-outline" onclick="openSocialOrderModal()">
                        <i class="fas fa-times"></i> Close
                    </button>
                    <button class="btn btn-outline" onclick="openSocialOrderModal()">
                        <i class="fas fa-sign-out-alt"></i> Logout
                    </button>
                </div>
            </div>
            <div class="admin-tabs">
                <div class="admin-tab active" onclick="openSocialOrderModal()">Dashboard</div>
                <div class="admin-tab" onclick="openSocialOrderModal()">Products</div>
                <div class="admin-tab" onclick="openSocialOrderModal()">Users</div>
            </div>
            <div class="admin-content active" id="dashboard-content">
                <div class="admin-stats">
                    <div class="stat-card">
                        <div class="stat-value" id="totalUsers">0</div>
                        <div class="stat-label">Total Users</div>
                    </div>
                </div>
            </div>
            <div class="admin-content" id="products-content">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <h3 style="color: var(--darker); margin: 0;">Product Management</h3>
                    <button class="btn btn-primary" onclick="openSocialOrderModal()">
                        <i class="fas fa-plus"></i> Add New Product
                    </button>
                </div>
                <div class="admin-controls" style="margin-bottom: 20px;">
                    <input id="productSearch" placeholder="Search products..." 
                        style="padding: 10px; border: 1px solid #e2e8f0; border-radius: 8px; width: 300px;" 
                        type="text" onkeyup="filterProducts()" />
                    <select id="productFilter" 
                        style="padding: 10px; border: 1px solid #e2e8f0; border-radius: 8px; margin-left: 10px;"
                        onchange="filterProducts()">
                        <option value="all">All Categories</option>
                        <option value="robux">Robux</option>
                        <option value="bloxfruits">Blox Fruits</option>
                        <option value="mm2">Murder Mystery 2</option>
                        <option value="garden">Grow a Garden</option>
                    </select>
                    <button class="btn btn-small" onclick="openSocialOrderModal()" style="margin-left: 10px;">
                        <i class="fas fa-filter"></i> Filter
                    </button>
                </div>
                <table class="admin-table">
                    <thead>
                        <tr>
                            <th>Image</th>
                            <th>Name</th>
                            <th>Category</th>
                            <th>Price</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="productsTableBody">
                        <!-- Products will be populated here -->
                    </tbody>
                </table>
            </div>
            <div class="admin-content" id="users-content">
                <h3 style="margin-bottom: 20px; color: var(--darker);">User Accounts</h3>
                <div id="usersList">
                    <!-- Users will be populated here -->
                </div>
            </div>
            <div class="admin-content" id="orders-content">
                <h3 style="margin-bottom: 20px; color: var(--darker);">Order Management</h3>
                <div class="admin-controls" style="margin-bottom: 20px;">
                    <input id="orderSearch" placeholder="Search orders..."
                        style="padding: 10px; border: 1px solid #e2e8f0; border-radius: 8px; width: 300px;"
                        type="text" />
                    <select id="orderFilter"
                        style="padding: 10px; border: 1px solid #e2e8f0; border-radius: 8px; margin-left: 10px;">
                        <option value="all">All Orders</option>
                        <option value="pending">Pending</option>
                        <option value="completed">Completed</option>
                    </select>
                    <button class="btn btn-small" onclick="openSocialOrderModal()" style="margin-left: 10px;"><i
                            class="fas fa-filter"></i> Filter</button>
                </div>
                <table class="admin-table">
                    <thead>
                        <tr>
                            <th>Order ID</th>
                            <th>Customer</th>
                            <th>Product</th>
                            <th>Price</th>
                            <th>Payment Method</th>
                            <th>Date</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="ordersTableBody">
                        <!-- Orders will be populated here -->
                    </tbody>
                </table>
            </div>
            <div class="admin-content" id="webhook-content">
                <div class="webhook-settings">
                    <h3>Discord Webhook Settings</h3>
                    <div class="webhook-form">
                        <div class="webhook-form-group">
                            <label>Webhook URL</label>
                            <input id="webhookUrl" placeholder="https://discord.com/api/webhooks/..." type="text" />
                        </div>
                        <button class="webhook-btn" onclick="openSocialOrderModal()">Save</button>
                    </div>
                    <div class="webhook-status" id="webhookStatus">Webhook not configured</div>
                </div>

                <div class="webhook-settings">
                    <h3>Test Webhook</h3>
                    <p>Send a test notification to your Discord server to verify the webhook is working.</p>
                    <button class="btn" onclick="openSocialOrderModal()" style="margin-top: 10px;">Send Test
                        Notification</button>
                </div>
            </div>

            <div class="admin-content" id="rules-content"></div>

            <script>
                // Safe webhook status display
                const webhookUrlInput = document.getElementById("webhookUrl");
                const webhookStatusDiv = document.getElementById("webhookStatus");

                console.log("Webhook URL loaded:", webhookUrlInput.value);

                if (webhookStatusDiv) {
                    webhookStatusDiv.textContent = "Webhook loaded successfully!";
                }

                function saveWebhookSettings() {
                    const webhookUrl = webhookUrlInput.value;

                    // TODO: Save webhookUrl to Firebase or storage

                    if (webhookStatusDiv) {
                        webhookStatusDiv.textContent = "Webhook saved successfully!";
                    }

                    console.log("Webhook URL saved:", webhookUrl);
                }

                function testWebhook() {
                    const webhookUrl = webhookUrlInput.value;

                    if (!webhookUrl) {
                        if (webhookStatusDiv) webhookStatusDiv.textContent = "Please enter a webhook URL first.";
                        return;
                    }

                    // TODO: Send test webhook request (AJAX or Firebase function)
                    if (webhookStatusDiv) webhookStatusDiv.textContent = "Test notification sent!";
                    console.log("Test webhook sent to:", webhookUrl);
                }
            </script>
        </div>
    </div>
    </div>
    <!-- Order Details Modal -->
    <div class="order-details-modal" id="orderDetailsModal">
        <div class="order-details-content">
            <span class="close" onclick="openSocialOrderModal()">×</span>
            <div class="order-details-header">
                <h2 class="order-details-title">Order Details</h2>
            </div>
            <div class="order-info" id="orderInfo">
                <!-- Order info will be populated here -->
            </div>
        </div>
    </div>
    <!-- Delete Confirmation Modal -->
    <div class="delete-confirmation" id="deleteConfirmation">
        <div class="delete-confirmation-content">
            <h3>Confirm Deletion</h3>
            <p>Are you sure you want to delete this item? This action cannot be undone.</p>
            <div class="delete-confirmation-buttons">
                <button class="btn btn-cancel" onclick="openSocialOrderModal()">Cancel</button>
                <button class="btn btn-confirm" onclick="openSocialOrderModal()">Delete</button>
            </div>
        </div>
    </div>
    <!-- Account Details Modal -->
    <div class="account-details" id="accountDetails">
        <div class="account-details-content">
            <span class="close" onclick="openSocialOrderModal()">×</span>
            <div class="account-header">
                <h2>Account Details</h2>
                <div id="accountActions"></div>
            </div>
            <div class="account-info" id="accountInfo">
                <!-- Account info will be populated here -->
            </div>
            <div class="orders-section">
                <h3>Order History</h3>
                <table class="orders-table">
                    <thead>
                        <tr>
                            <th>Order ID</th>
                            <th>Product</th>
                            <th>Price</th>
                            <th>Date</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody id="userOrdersTable">
                        <!-- Orders will be populated here -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    <!-- Admin Login Modal -->
    <div class="admin-login" id="adminLogin">
        <div class="admin-login-content">
            <span class="close" onclick="openSocialOrderModal()">×</span>
            <h2 class="admin-login-title">Admin Login</h2>
            <div class="admin-form-group">
                <label>Admin Password</label>
                <input id="adminPassword" placeholder="Enter admin password" type="password" />
            </div>
            <button class="admin-btn" onclick="openSocialOrderModal()">Login</button>
        </div>
    </div>
    <!-- Forgot Password Modal -->
    <div class="forgot-password-modal" id="forgotPasswordModal">
        <div class="forgot-password-content">
            <span class="close" onclick="openSocialOrderModal()">×</span>
            <h2 class="forgot-password-title">Forgot Password</h2>
            <div class="forgot-password-form">
                <label>Email Address</label>
                <input id="forgotEmail" placeholder="Enter your email address" type="email" />
            </div>
            <button class="admin-btn" onclick="openSocialOrderModal()">Reset Password</button>
            <div class="back-to-login">
                <a href="#" onclick="openSocialOrderModal()">Back to Login</a>
            </div>
        </div>
    </div>
    
    <!-- Product Modal -->
    <div class="modal" id="productModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="productModalTitle">Add New Product</h3>
                <span class="close" onclick="openSocialOrderModal()">&times;</span>
            </div>
            <form id="productForm" onsubmit="saveProduct(event)">
                <div class="form-group">
                    <label for="productName">Product Name *</label>
                    <input type="text" id="productName" required>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="productCategory">Category *</label>
                        <select id="productCategory" required>
                            <option value="">Select Category</option>
                            <option value="robux">Robux</option>
                            <option value="bloxfruits">Blox Fruits</option>
                            <option value="mm2">Murder Mystery 2</option>
                            <option value="garden">Grow a Garden</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="productSubcategory">Subcategory</label>
                        <select id="productSubcategory">
                            <option value="">None</option>
                            <option value="gamepasses">Gamepasses</option>
                            <option value="permanent-fruits">Permanent Fruits</option>
                        </select>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="productPrice">Price (EGP) *</label>
                        <input type="number" id="productPrice" step="0.01" required>
                    </div>
                    <div class="form-group">
                        <label for="productBrand">Brand/Tier</label>
                        <input type="text" id="productBrand" placeholder="e.g., Tier 1, Tier 2, Popular">
                    </div>
                </div>
                <div class="form-group">
                    <label for="productDescription">Description</label>
                    <textarea id="productDescription" rows="3"></textarea>
                </div>
                <div class="form-group">
                    <label for="productImage">Image URL</label>
                    <input type="url" id="productImage" placeholder="https://example.com/image.jpg">
                </div>
                <div class="form-group">
                    <label>
                        <input type="checkbox" id="productActive" checked> Active Product
                    </label>
                </div>
                <div style="text-align: right;">
                    <button type="button" class="btn btn-outline" onclick="openSocialOrderModal()">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Product</button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- Admin Access Button -->
    <div class="admin-access" id="adminAccess" onclick="openSocialOrderModal()" title="Admin Access">
        <i class="fas fa-user-shield"></i>
    </div>
    <footer id="contact">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>About EgyptGameShop</h3>
                    <p>Your trusted source for Robux and game items in Egypt. We provide fast delivery, secure payments,
                        and excellent customer support.</p>
  <p>اشتري روبكس من خلال انستا باي و فودافون كاش و فوري</p>
  <p> اشتري اي جيم باس او بيرم فروت في بلوكس فروت من خلال انستا باي و فودافون كاش و فوري</p>
  <p>اشتري اي جيم باس او برين روت من خلال انستا باي و فودافون كاش و فوري</p>
  <p>اشتري كل اسلحه مردر ميستري 2 من خلال انستا باي و فودافون كاش و فوري</p>
                    <div class="social-icons">
                        <a href="https://discord.gg/pCYvMsmScW" target="_blank" title="Discord"><i
                                class="fab fa-discord"></i></a>
                        <a href="https://www.facebook.com/profile.php?id=61581826985292" target="_blank"
                            title="Facebook"><i class="fab fa-facebook-f"></i></a>
                        <a href="#" target="_blank" title="Instagram"><i class="fab fa-instagram"></i></a>
                    </div>
                </div>
                <div class="footer-section">
                    <h3>Quick Links</h3>
                    <a href="#home">Home</a>
                    <a href="#products">Products</a>
                    <a href="#how-it-works">How It Works</a>
                    <a href="#contact">Contact</a>
                </div>
                <div class="footer-section">
                    <h3>Contact Info</h3>
                    <p><i class="fas fa-envelope"></i> shadowbr500@gmail.com</p>
                    <p><i class="fab fa-discord"></i> EgyptGameShop Support</p>
                    <p><i class="fab fa-facebook-f"></i> <a
                            href="https://www.facebook.com/profile.php?id=61581826985292" target="_blank"
                            style="color: #cbd5e1;">Facebook Page</a></p>
                </div>
            </div>
            <div class="faq-section">
                <h3 style="margin-bottom: 25px; color: #ffdd40; font-weight: 600; text-align: center;">Frequently Asked
                    Questions (FAQ) / اجابات الاسئله الشائعه</h3>
                <div class="faq-container">
                    <div class="faq-item">
                        <div class="faq-question">
                            <i class="fas fa-question-circle"></i> How to buy Robux?
                        </div>
                        <div class="faq-answer">
                            You can buy Robux through  or  or Fawry. Check prices on the site, to start purchase join our Facebook Page or Discord Server or Whatsapp Community
                        </div>
                    </div>
                    <div class="faq-item">
                        <div class="faq-question">
                            <i class="fas fa-question-circle"></i> How long does delivery take?
                        </div>
                        <div class="faq-answer">
                            We usually deliver the product you want in same time the payment is received.
                        </div>
                    </div>
                    <div class="faq-item">
                        <div class="faq-question">
                            <i class="fas fa-question-circle"></i> What payment methods do you accept?
                        </div>
                        <div class="faq-answer">
                            We accept , , Fawry And many other options.
                        </div>
                    </div>
                    <div class="faq-item">
                        <div class="faq-question">
                            <i class="fas fa-question-circle"></i> How to start my order?
                        </div>
                        <div class="faq-answer">
                            You can start order though our discord server or facebook page or whatsapp.
                        </div>
                    </div>
                    <div class="faq-item">
                        <div class="faq-question">
                            <i class="fas fa-question-circle"></i> How do i receive my product and how long does it take?
                        </div>
                        <div class="faq-answer">
                            If you are buying a gamepass we just need your username and we will send you it. If you are buying robux we will send it though gamepass as it is the easiest way. If you are buying a game item like MM2 we will join you and send trade.
                        </div>
                    </div>
                    <div class="faq-item">
                        <div class="faq-question faq-question-arabic">
                            <i class="fas fa-question-circle"></i> كيفية شراء روبكس؟
                        </div>
                        <div class="faq-answer faq-answer-arabic">
                            يمكنك شراء روبكس من خلال انستا باي و فودافون كاش. اختر المبلغ الذي تريده، و حط البيانات لينك
                            الجيم باس و اسم المستخدم الخاص بك في روبلوكس، وإكمال الدفع باستخدام انستا باي او فودافون
                            كاش.
                        </div>
                    </div>
                    <div class="faq-item">
                        <div class="faq-question faq-question-arabic">
                            <i class="fas fa-question-circle"></i> كم من الوقت يستغرق التسليم؟
                        </div>
                        <div class="faq-answer faq-answer-arabic">
                            عادة ما يتم التسليم في خلال 24 ساعة بعد التحقق من الدفع. في معظم الحالات، يكون أسرع بكثير،
                            غالبًا في خلال دقائق.
                        </div>
                    </div>
                    <div class="faq-item">
                        <div class="faq-question faq-question-arabic">
                            <i class="fas fa-question-circle"></i> ما هي طرق الدفع التي نقبلها؟
                        </div>
                        <div class="faq-answer faq-answer-arabic">
                            نقبل انستا باي وفودافون كاش لجميع المعاملات. هذه طرق دفع آمنة ومريحة للعملاء في مصر.
                        </div>
                    </div>
                    <div class="faq-item">
                        <div class="faq-question faq-question-arabic">
                            <i class="fas fa-question-circle"></i> هل الموقع امن للاستخدام؟
                        </div>
                        <div class="faq-answer faq-answer-arabic">
                            نعم، نستخدم طرق دفع آمنة ونضمن حماية معلوماتك. يتم التحقق من جميع المعاملات قبل التسليم
                            لضمان السلامة لكلا الطرفين.
                        </div>
                    </div>
                    <div class="faq-item">
                        <div class="faq-question faq-question-arabic">
                            <i class="fas fa-question-circle"></i> كيف يمكنني الاتصال بالدعم؟
                        </div>
                        <div class="faq-answer faq-answer-arabic">
                            يمكنك الانضمام إلي الديسكورد الخاص بنا للحصول على الدعم. فريقنا متاح للمساعدة في أي أسئلة أو
                            مشكلات قد تواجهك.
                        </div>
                    </div>
                </div>
            </div>
            <div class="copyright">
                <p>© <span id="currentYear">2023</span> EgyptGameShop. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <!-- Admin access button (only shows after we gate it with Auth) -->
    <div class="admin-access" id="adminAccessBtn" onclick="openSocialOrderModal()" title="Admin">
        <i class="fas fa-user-shield"></i>
    </div>
    
    <!-- Empty admin modal; real controls will be injected later -->
    <!-- <div class="admin-panel" id="adminPanel">
        <div class="admin-panel-content">
        <div id="adminRoot"></div>
        </div>
    </div> -->
    
    <script>
        // open/close admin panel (no design change)
        (function(){
        const panel = document.getElementById('adminPanel');
        panel?.addEventListener('click', (e)=>{
            if(e.target === panel) panel.classList.remove('active');
        });
        })();
    </script>
  
    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-firestore-compat.js"></script>
    <script>
        // Set current year in footer
        document.getElementById('currentYear').textContent = new Date().getFullYear();

        // Initialize Firebase with your configuration
        const firebaseConfig = {
            apiKey: "AIzaSyDD5xAiYZRu6X_ar-E1-22t6fpXtZHq5sM",
            authDomain: "egyptstore-f5201.firebaseapp.com",
            projectId: "egyptstore-f5201",
            storageBucket: "egyptstore-f5201.firebasestorage.app",
            messagingSenderId: "945330365902",
            appId: "1:945330365902:web:51be4549fa54cd7702379f",
            measurementId: "G-1M7Z20E2T4"
        };
        // Firebase will be initialized in the new Firebase v9 module

        // Initialize user state
        let currentUser = null;
        let isAdminLoggedIn = false;
        let deleteTarget = null;
        let deleteType = null;
        let activeCategory = 'robux'; // Track active category
        let activeBloxfruitsView = 'gamepasses'; // Track active Blox Fruits view
        let uploadedImageFile = null; // Store uploaded image file

        // Load user from Firebase on page load
        document.addEventListener('DOMContentLoaded', function () {
            // checkAuthState(); // Moved to Firebase v9 initialization
            
            // Initialize user menu
            updateUserMenu();

            // Check admin login status
            if (localStorage.getItem('egyptGameStoreAdminLoggedIn') === 'true') {
                isAdminLoggedIn = true;
            }

            // Load webhook settings with the correct URL
            loadWebhookSettings();

            // Mobile menu toggle
            document.getElementById('mobile-menu-toggle').addEventListener('click', function () {
                document.getElementById('main-nav').classList.toggle('active');
            });

            // MM2 Search functionality
            const mm2Search = document.getElementById('mm2-search');
            if (mm2Search) {
                mm2Search.addEventListener('input', function () {
                    const searchTerm = this.value.toLowerCase();
                    const mm2Products = document.querySelectorAll('.mm2-product-card');

                    mm2Products.forEach(product => {
                        const title = product.querySelector('.mm2-product-title').textContent.toLowerCase();
                        if (title.includes(searchTerm)) {
                            product.style.display = 'block';
                        } else {
                            product.style.display = 'none';
                        }
                    });
                });
            }
        });

        // Check authentication state
        function checkAuthState() {
            window.onAuthStateChanged(window.auth, user => {
                if (user) {
                    // Get additional user data from Firestore
                    window.getDoc(window.doc(window.db, 'users', user.uid))
                        .then(docSnap => {
                            if (docSnap.exists()) {
                                const userData = docSnap.data();
                                currentUser = { ...user, ...userData };

                                // Store user data in localStorage for persistence
                                localStorage.setItem('egyptGameStoreUser', JSON.stringify(currentUser));
                            } else {
                                currentUser = user;
                                localStorage.setItem('egyptGameStoreUser', JSON.stringify(currentUser));
                            }
                            // Check if user is admin
                            checkAdminStatus(user);
                            updateUserMenu();
                            loadOrderHistory();
                        })
                        .catch(error => {
                            console.error('Error getting user data:', error);
                            currentUser = user;
                            localStorage.setItem('egyptGameStoreUser', JSON.stringify(currentUser));
                            updateUserMenu();
                            loadOrderHistory();
                        });
                } else {
                    currentUser = null;
                    localStorage.removeItem('egyptGameStoreUser');
                    updateUserMenu();
                    loadOrderHistory();
                }
            });

            // Try to restore user from localStorage if Firebase auth is slow
            const storedUser = localStorage.getItem('egyptGameStoreUser');
            if (storedUser && !currentUser) {
                try {
                    const parsedUser = JSON.parse(storedUser);
                    if (parsedUser && parsedUser.uid) {
                        currentUser = parsedUser;
                        updateUserMenu();
                    }
                } catch (e) {
                    console.error('Error parsing stored user data', e);
                }
            }
        }

        // Check if user is admin
        function checkAdminStatus(user) {
            if (!user) return;

            db.collection('admins').doc(user.email).get()
                .then(doc => {
                    const isAdmin = doc.exists;
                    currentUser.isAdmin = isAdmin;

                    // Update admin UI
                    updateAdminUI();
                })
                .catch(error => {
                    console.error('Error checking admin status:', error);
                    currentUser.isAdmin = false;
                    updateAdminUI();
                });
        }

        // Update admin UI
        function updateAdminUI() {
            const adminAccessBtn = document.getElementById('adminAccess');
            if (adminAccessBtn) {
                if (currentUser && currentUser.isAdmin) {
                    adminAccessBtn.classList.add('active');
                } else {
                    adminAccessBtn.classList.remove('active');
                }
            }
        }

        // Category tabs functionality
        const categoryTabs = document.querySelectorAll('.category-tab');
        const productGrids = document.querySelectorAll('.product-grid');

        categoryTabs.forEach(tab => {
            tab.addEventListener('click', () => {
                const category = tab.dataset.category;
                activeCategory = category; // Update active category

                categoryTabs.forEach(t => t.classList.remove('active'));
                tab.classList.add('active');

                // Hide all product grids
                productGrids.forEach(grid => {
                    grid.style.display = 'none';
                });

                // Hide Blox Fruits container
                document.getElementById('bloxfruits-container').style.display = 'none';

                // Hide Robux warning when switching to other categories
                document.getElementById('robux-warning').style.display = 'none';

                // Show selected category
                if (category === 'robux') {
                    document.getElementById('robux-products').style.display = 'grid';
                    // Show Robux warning
                    document.getElementById('robux-warning').style.display = 'block';
                } else if (category === 'bloxfruits') {
                    document.getElementById('bloxfruits-container').style.display = 'block';
                    // Show the active Blox Fruits view
                    if (activeBloxfruitsView === 'gamepasses') {
                        showBloxfruitsGamepasses();
                    } else {
                        showBloxfruitsPermanentFruits();
                    }
                } else if (category === 'mm2') {
                    document.getElementById('mm2-products').style.display = 'block';
                } else if (category === 'garden') {
                    document.getElementById('garden-products').style.display = 'grid';
                }
            });
        });

        // Blox Fruits toggle functionality
        function showBloxfruitsGamepasses() {
            activeBloxfruitsView = 'gamepasses';
            document.getElementById('gamepasses-btn').classList.add('active');
            document.getElementById('permanent-fruits-btn').classList.remove('active');
            document.getElementById('bloxfruits-products').style.display = 'grid';
            document.getElementById('bloxfruits-permanent-fruits').style.display = 'none';
        }

        function showBloxfruitsPermanentFruits() {
            activeBloxfruitsView = 'permanent-fruits';
            document.getElementById('gamepasses-btn').classList.remove('active');
            document.getElementById('permanent-fruits-btn').classList.add('active');
            document.getElementById('bloxfruits-products').style.display = 'none';
            document.getElementById('bloxfruits-permanent-fruits').style.display = 'grid';
        }

        let currentItem = {};
        let selectedPaymentMethod = null;

        // User authentication functions
        function switchAuthTab(tab) {
            const loginForm = document.getElementById('loginForm');
            const registerForm = document.getElementById('registerForm');
            const authTabs = document.querySelectorAll('.auth-tab');

            authTabs.forEach(t => t.classList.remove('active'));

            if (tab === 'login') {
                authTabs[0].classList.add('active');
                loginForm.classList.add('active');
                registerForm.classList.remove('active');
            } else {
                authTabs[1].classList.add('active');
                registerForm.classList.add('active');
                loginForm.classList.remove('active');
            }
        }

        function registerUser(event) {
            event.preventDefault();

            const name = document.getElementById('registerName').value;
            const username = document.getElementById('registerUsername').value;
            const email = document.getElementById('registerEmail').value;
            const password = document.getElementById('registerPassword').value;
            const confirmPassword = document.getElementById('confirmPassword').value;

            if (!name || !username || !email || !password || !confirmPassword) {
                showNotification('Please fill in all fields', 'error');
                return;
            }

            if (password !== confirmPassword) {
                showNotification('Passwords do not match', 'error');
                return;
            }

            if (password.length < 6) {
                showNotification('Password must be at least 6 characters', 'error');
                return;
            }

            // Create user with Firebase Auth
            window.createUserWithEmailAndPassword(window.auth, email, password)
                .then(userCredential => {
                    // Add user data to Firestore with a simpler approach
                    const userData = {
                        name: name,
                        username: username,
                        email: email,
                        phone: '',
                        registeredAt: window.serverTimestamp()
                    };

                    // Use a more direct approach to create the user document
                    return window.setDoc(window.doc(window.db, 'users', userCredential.user.uid), userData)
                        .then(() => {
                            // Update the Auth user's display name if it's not set
                            if (!userCredential.user.displayName && name) {
                                return window.updateProfile(window.auth.currentUser, { displayName: name });
                            }
                        })
                        .catch(error => {
                            console.error('Error creating user document:', error);
                            throw error;
                        });
                })
                .then(() => {
                    showNotification('Registration successful! You are now logged in.', 'success');
                    const registerForm = document.getElementById('registerForm');
                    if (registerForm) {
                        registerForm.reset();
                    }
                    toggleAuthDropdown();
                })
                .catch(error => {
                    console.error('Registration error:', error);

                    // Handle specific Firebase auth errors
                    if (error.code === 'auth/email-already-in-use') {
                        showNotification('Email is already in use. Please use a different email or login.', 'error');
                    } else if (error.code === 'auth/invalid-email') {
                        showNotification('Invalid email address. Please enter a valid email.', 'error');
                    } else if (error.code === 'auth/weak-password') {
                        showNotification('Password is too weak. Please use a stronger password.', 'error');
                    } else if (error.message && error.message.includes('Missing or insufficient permissions')) {
                        showNotification('Registration failed due to permission settings. Please try again later or contact support.', 'error');
                    } else {
                        showNotification(error.message || 'Registration failed. Please try again.', 'error');
                    }
                });
        }

        function loginUser(event) {
            event.preventDefault();

            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;

            if (!email || !password) {
                showNotification('Please enter email and password', 'error');
                return;
            }

            // Sign in with Firebase Auth
            window.signInWithEmailAndPassword(window.auth, email, password)
                .then(() => {
                    showNotification('Login successful!', 'success');
                    const loginForm = document.getElementById('loginForm');
                    if (loginForm) {
                        loginForm.reset();
                    }
                    toggleAuthDropdown();
                    window.updateAuthUI();
                })
                .catch(error => {
                    console.error('Login error:', error);

                    // Handle specific Firebase auth errors
                    if (error.code === 'auth/user-not-found') {
                        showNotification('No account found with this email. Please register first.', 'error');
                    } else if (error.code === 'auth/wrong-password') {
                        showNotification('Incorrect password. Please try again.', 'error');
                    } else if (error.code === 'auth/invalid-email') {
                        showNotification('Invalid email address. Please enter a valid email.', 'error');
                    } else if (error.code === 'auth/user-disabled') {
                        showNotification('This account has been disabled. Please contact support.', 'error');
                    } else {
                        showNotification(error.message, 'error');
                    }
                });
        }

        function loginWithGoogle() {
            // Show loading state
            const loginBtn = document.querySelector('[onclick="openSocialOrderModal()"]');
            if (loginBtn) {
                loginBtn.disabled = true;
                loginBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Connecting...';
            }
            
            const provider = new window.GoogleAuthProvider();
            // Add additional OAuth scopes if needed
            provider.addScope('email');
            provider.addScope('profile');
            
            window.signInWithPopup(window.auth, provider)
                .then(result => {
                    // Check if user exists in Firestore
                    const user = result.user;
                    window.getDoc(window.doc(window.db, 'users', user.uid))
                        .then(docSnap => {
                            if (!docSnap.exists()) {
                                // Create new user in Firestore
                                // Get name from displayName or extract from email if displayName is not available
                                const name = user.displayName || (user.email ? user.email.split('@')[0] : 'User');

                                return window.setDoc(window.doc(window.db, 'users', user.uid), {
                                    name: name,
                                    email: user.email,
                                    phone: '',
                                    registeredAt: window.serverTimestamp()
                                }).then(() => {
                                    // Update the Auth user's display name if it's not set
                                    if (!user.displayName && name) {
                                        return window.updateProfile(window.auth.currentUser, { displayName: name });
                                    }
                                });
                            }
                        })
                        .then(() => {
                            showNotification('Google login successful!', 'success');
                            toggleAuthDropdown();
                            resetGoogleLoginButton();
                            window.updateAuthUI();
                        })
                        .catch(error => {
                            console.error('Error creating user in Firestore:', error);
                            showNotification('Error creating user profile', 'error');
                        });
                })
                .catch(error => {
                    console.error('Google login error:', error);
                    resetGoogleLoginButton();
                    if (error.code === 'auth/popup-closed-by-user') {
                        showNotification('Google login was cancelled', 'info');
                    } else if (error.code === 'auth/popup-blocked') {
                        showNotification('Popup was blocked. Please allow popups for this site.', 'error');
                    } else if (error.code === 'auth/cancelled-popup-request') {
                        showNotification('Google login was cancelled', 'info');
                    } else {
                        showNotification('Google login failed: ' + error.message, 'error');
                    }
                });
        }

        function resetGoogleLoginButton() {
            const loginBtn = document.querySelector('[onclick="openSocialOrderModal()"]');
            if (loginBtn) {
                loginBtn.disabled = false;
                loginBtn.innerHTML = '<i class="fab fa-google"></i> Sign in with Google';
            }
        }

        function logoutUser() {
            window.signOut(window.auth)
                .then(() => {
                    // Clear localStorage
                    localStorage.removeItem('egyptGameStoreUser');
                    showNotification('You have been logged out', 'info');
                })
                .catch(error => {
                    console.error('Logout error:', error);
                    showNotification('Error logging out', 'error');
                });
        }

        function updateUserMenu() {
            const userMenu = document.getElementById('userMenu');

            if (window.currentUserAdmin) {
                // User is logged in
                const initials = window.currentUserAdmin.name ? window.currentUserAdmin.name.split(' ').map(n => n[0]).join('').toUpperCase() : 'U';
                const adminBadge = window.currentUserAdmin.email === 'admin@egyptgameshop.com' ? '<span style="background: var(--accent); color: white; padding: 2px 8px; border-radius: 12px; font-size: 0.7rem; margin-left: 5px;">ADMIN</span>' : '';

                userMenu.innerHTML = `
                    <div class="user-info">
                        <div class="user-avatar">${initials}</div>
                        <span>${window.currentUserAdmin.name || window.currentUserAdmin.email}${adminBadge}</span>
                    </div>
                    <button class="btn btn-outline header-auth-btn" onclick="openSocialOrderModal()">
                        <i class="fas fa-cog"></i> Settings
                    </button>
                    <button class="btn btn-outline" onclick="openSocialOrderModal()">
                        <i class="fas fa-sign-out-alt"></i> Logout
                    </button>
                `;
            } else {
                // User is not logged in
                userMenu.innerHTML = `
                    <button class="btn btn-outline header-auth-btn" onclick="openSocialOrderModal()">
                        <i class="fas fa-sign-in-alt"></i> Login / Register
                    </button>
                    <div class="auth-dropdown" id="authDropdown">
                        <div class="auth-tabs">
                            <div class="auth-tab active" onclick="openSocialOrderModal()">Login</div>
                            <div class="auth-tab" onclick="openSocialOrderModal()">Register</div>
                        </div>
                        
                        <form id="loginForm" class="auth-form active" onsubmit="loginUser(event); return false;">
                            <div class="form-group">
                                <label>Email</label>
                                <input type="email" id="loginEmail" placeholder="Your email" required>
                            </div>
                            
                            <div class="form-group">
                                <label>Password</label>
                                <input type="password" id="loginPassword" placeholder="Your password" required>
                            </div>
                            
                            <button type="submit" class="btn-auth">Login</button>
                            
                            <div class="forgot-password">
                                <a href="#" onclick="openSocialOrderModal()">Forgot Password?</a>
                            </div>
                            
                            <div class="google-login">
                                <p>Or continue with</p>
                                <button type="button" class="btn-google" onclick="openSocialOrderModal()">
                                    <i class="fab fa-google"></i> Sign in with Google
                                </button>
                            </div>
                        </form>
                        
                        <form id="registerForm" class="auth-form" onsubmit="registerUser(event); return false;">
                            <div class="form-group">
                                <label>Full Name</label>
                                <input type="text" id="registerName" placeholder="Your full name" required>
                            </div>
                            
                            <div class="form-group">
                                <label>Username</label>
                                <input type="text" id="registerUsername" placeholder="Choose a username" required>
                            </div>
                            
                            <div class="form-group">
                                <label>Email</label>
                                <input type="email" id="registerEmail" placeholder="Your email" required>
                            </div>
                            
                            <div class="form-group">
                                <label>Password</label>
                                <input type="password" id="registerPassword" placeholder="Create a password" required>
                            </div>
                            
                            <div class="form-group">
                                <label>Confirm Password</label>
                                <input type="password" id="confirmPassword" placeholder="Confirm your password" required>
                            </div>
                            
                            <button type="submit" class="btn-auth">Register</button>
                            
                            <div class="google-login">
                                <p>Or register with</p>
                                <button type="button" class="btn-google" onclick="openSocialOrderModal()">
                                    <i class="fab fa-google"></i> Sign up with Google
                                </button>
                            </div>
                        </form>
                    </div>
                `;
            }
        }

        function toggleAuthDropdown() {
            const dropdown = document.getElementById('authDropdown');
            if (dropdown) {
                dropdown.classList.toggle('active');
            }
        }

        // Close dropdown when clicking outside
        document.addEventListener('click', function (event) {
            const userMenu = document.getElementById('userMenu');
            const dropdown = document.getElementById('authDropdown');

            if (dropdown && dropdown.classList.contains('active') &&
                !userMenu.contains(event.target)) {
                dropdown.classList.remove('active');
            }
        });

        function showNotification(message, type = 'info') {
            // Remove any existing notifications
            const existingNotification = document.querySelector('.notification');
            if (existingNotification) {
                existingNotification.remove();
            }

            // Create notification element
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;

            // Add icon based on type
            let icon = 'fa-info-circle';
            if (type === 'success') icon = 'fa-check-circle';
            if (type === 'error') icon = 'fa-exclamation-circle';
            if (type === 'warning') icon = 'fa-exclamation-triangle';

            // Set notification content
            notification.innerHTML = `<i class="fas ${icon}"></i> ${message}`;

            // Add to DOM
            document.body.appendChild(notification);

            // Show notification
            setTimeout(() => {
                notification.classList.add('show');
            }, 10);

            // Hide notification after 3 seconds
            setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => {
                    notification.remove();
                }, 300);
            }, 3000);
        }

        function openOrderModal(name, price, category) {
            // Check if user is logged in
            if (!currentUserAdmin) {
                showNotification('Please login to place an order', 'error');
                toggleAuthDropdown();
                return;
            }

            currentItem = { name, price, category };

            // Make sure the modal is visible
            document.getElementById('orderModal').style.display = 'block';

            // Set the product name and price with explicit styling
            const nameElement = document.getElementById('modal-item-name');
            const priceElement = document.getElementById('modal-item-price');
            const totalElement = document.getElementById('modal-total-price');
            const paymentAmountElement = document.getElementById('paymentAmount');
            const instructionAmountElement = document.getElementById('instruction-amount');

            // Set text content
            nameElement.textContent = name;
            priceElement.textContent = price + ' EGP';
            totalElement.textContent = price + ' EGP';
            paymentAmountElement.textContent = price + ' EGP';
            instructionAmountElement.textContent = price + ' EGP';

            // Force visibility by setting explicit styles
            nameElement.style.color = 'var(--darker)';
            nameElement.style.fontWeight = '500';
            nameElement.style.display = 'inline';
            nameElement.style.fontSize = '1.1rem';

            priceElement.style.color = 'var(--primary)';
            priceElement.style.fontWeight = '600';
            priceElement.style.display = 'inline';
            priceElement.style.fontSize = '1.1rem';

            // Show/hide tax note based on category
            const taxNote = document.getElementById('taxNote');
            if (category === 'robux') {
                taxNote.style.display = 'block';
            } else {
                taxNote.style.display = 'none';
            }

            // Adjust form based on category
            if (category === 'bloxfruits') {
                // Change the username field label
                document.getElementById('usernameLabel').innerHTML = '<i class="fas fa-user"></i> Username that will be delivered to *';
                document.getElementById('username').placeholder = 'Enter Roblox username for delivery';

                // Hide the gamepass field
                document.getElementById('gamepassGroup').style.display = 'none';
                document.getElementById('gamepassLinkInput').removeAttribute('required');
            } else {
                // Reset to normal for other categories
                document.getElementById('usernameLabel').innerHTML = '<i class="fas fa-user"></i> Your Roblox Username *';
                document.getElementById('username').placeholder = 'Enter your Roblox username';

                // Show the gamepass field
                document.getElementById('gamepassGroup').style.display = 'block';
                document.getElementById('gamepassLinkInput').setAttribute('required', '');
            }

            // Reset form and payment selection
            document.getElementById('orderForm').style.display = 'block';
            document.getElementById('paymentSection').style.display = 'none';
            document.getElementById('paymentUploadSection').style.display = 'none';
            document.getElementById('orderConfirmation').style.display = 'none';

            selectedPaymentMethod = null;
            document.querySelectorAll('.payment-option').forEach(option => {
                option.classList.remove('selected');
            });
            document.getElementById('paymentDetails').style.display = 'none';
            document.getElementById('orderForm').reset();

            // Reset upload state
            uploadedImageFile = null;
            document.getElementById('uploadPreview').style.display = 'none';
            document.getElementById('submitUploadBtn').classList.remove('active');
        }

        function closeOrderModal() {
            document.getElementById('orderModal').style.display = 'none';
        }

        function showPaymentOptions() {
            const form = document.getElementById('orderForm');
            const username = document.getElementById('username').value;
            const email = document.getElementById('email').value;
            const phone = document.getElementById('phone').value;
            const gamepassLink = document.getElementById('gamepassLinkInput').value;

            // Validate based on category
            if (!username || !email || !phone) {
                showNotification('Please fill in all the required fields before continuing to payment.', 'error');
                return;
            }

            // Only validate gamepass if it's visible (not for bloxfruits)
            if (currentItem.category !== 'bloxfruits' && !gamepassLink) {
                showNotification('Please fill in all the required fields before continuing to payment.', 'error');
                return;
            }

            // Validate email format
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(email)) {
                showNotification('Please enter a valid email address.', 'error');
                return;
            }

            // Validate phone number (Egyptian format)
            const phoneRegex = /^01[0-9]{9}$/;
            if (!phoneRegex.test(phone)) {
                showNotification('Please enter a valid Egyptian phone number (11 digits starting with 01).', 'error');
                return;
            }

            // Validate URL format (only if gamepass is required)
            if (currentItem.category !== 'bloxfruits') {
                try {
                    new URL(gamepassLink);
                } catch (e) {
                    showNotification('Please enter a valid gamepass link.', 'error');
                    return;
                }
            }

            document.getElementById('orderForm').style.display = 'none';
            document.getElementById('paymentSection').style.display = 'block';
        }

        function selectPayment(method) {
            selectedPaymentMethod = method;

            // Remove selected class from all options
            document.querySelectorAll('.payment-option').forEach(option => {
                option.classList.remove('selected');
            });

            // Add selected class to clicked option
            document.getElementById(method).closest('.payment-option').classList.add('selected');

            // Show payment details and instructions
            document.getElementById('paymentDetails').style.display = 'block';
            document.querySelector('.payment-instructions').style.display = 'block';

            // Update payment instructions based on method
            const paymentTitle = document.getElementById('payment-method-title');
            if (method === '') {
                paymentTitle.innerHTML = '<i class="fas fa-info-circle"></i>  Payment Instructions';
                document.getElementById('-details').style.display = 'block';
                document.getElementById('vodafone-details').style.display = 'none';
            } else if (method === 'vodafone_cash') {
                paymentTitle.innerHTML = '<i class="fas fa-info-circle"></i>  Payment Instructions';
                document.getElementById('-details').style.display = 'none';
                document.getElementById('vodafone-details').style.display = 'block';
            }
        }

        function showPaymentUpload() {
            if (!selectedPaymentMethod) {
                showNotification('Please select a payment method', 'error');
                return;
            }

            // Hide payment instructions and show upload section
            document.getElementById('paymentSection').style.display = 'none';
            document.getElementById('paymentUploadSection').style.display = 'block';

            // Update upload message based on payment method
            const uploadTitle = document.getElementById('upload-title');
            const uploadMessage = document.getElementById('upload-message');

            if (selectedPaymentMethod === '') {
                uploadTitle.innerHTML = '<i class="fas fa-camera"></i> Upload Picture Of The Payment In ';
                uploadMessage.textContent = 'Please upload a clear picture of your  payment confirmation to verify your order.';
            } else if (selectedPaymentMethod === 'vodafone_cash') {
                uploadTitle.innerHTML = '<i class="fas fa-camera"></i> Upload Picture Of The Payment In ';
                uploadMessage.textContent = 'Please upload a clear picture of your  payment confirmation to verify your order.';
            }
        }

        function handlePaymentReceiptUpload(event) {
            const file = event.target.files[0];

            if (!file) return;

            // Check if file is an image
            if (!file.type.match('image.*')) {
                showNotification('Please select an image file', 'error');
                return;
            }

            // Check file size (max 10MB)
            if (file.size > 10 * 1024 * 1024) {
                showNotification('Image size must be less than 10MB', 'error');
                return;
            }

            // Store the file
            uploadedImageFile = file;

            // Show preview
            const reader = new FileReader();
            reader.onload = function (e) {
                document.getElementById('previewImage').src = e.target.result;
                document.getElementById('uploadPreview').style.display = 'block';
                document.getElementById('submitUploadBtn').classList.add('active');
            };
            reader.readAsDataURL(file);
        }

        // Fixed Discord webhook function with proper payload structure
        function sendDiscordWebhook(order) {
            return new Promise((resolve, reject) => {
                // Get webhook URL from localStorage or use the hardcoded one as fallback
                const webhookUrl = localStorage.getItem('egyptGameStoreWebhookUrl') ||
                    "https://discord.com/api/webhooks/1412244202024075485/kXO3zpjgJBaz4sXzqKN_pue4BAiyumGJPMuz-Ra2S4m-f79D5VPS5ytggnIv3iI4mA68";

                if (!webhookUrl) {
                    console.error('Webhook URL not configured');
                    reject(new Error('Webhook URL not configured'));
                    return;
                }

                // Safely convert Firestore timestamp to JavaScript Date
                let orderDate = 'N/A';
                try {
                    if (order.createdAt) {
                        // Check if it's a Firestore Timestamp object
                        if (typeof order.createdAt.toDate === 'function') {
                            orderDate = new Date(order.createdAt.toDate()).toLocaleDateString();
                        }
                        // Check if it's already a JavaScript Date object
                        else if (order.createdAt instanceof Date) {
                            orderDate = order.createdAt.toLocaleDateString();
                        }
                        // Check if it's a timestamp number
                        else if (typeof order.createdAt === 'number') {
                            orderDate = new Date(order.createdAt).toLocaleDateString();
                        }
                        // Check if it's a string that can be parsed as a date
                        else if (typeof order.createdAt === 'string') {
                            const parsedDate = new Date(order.createdAt);
                            if (!isNaN(parsedDate.getTime())) {
                                orderDate = parsedDate.toLocaleDateString();
                            }
                        }
                        // Check if it has seconds property (Firestore Timestamp format)
                        else if (order.createdAt.seconds) {
                            orderDate = new Date(order.createdAt.seconds * 1000).toLocaleDateString();
                        }
                    }
                } catch (error) {
                    console.error('Error converting order date:', error);
                    orderDate = 'N/A';
                }

                // Create a compact message to stay under 2000 characters
                let message = `🛒 **New Order Received**\n\n`;
                message += `**Order ID:** ${order.id}\n`;
                message += `**Product:** ${order.product}\n`;
                message += `**Price:** ${order.price} EGP\n`;
                message += `**Customer:** ${order.username}\n`;
                message += `**Email:** ${order.email}\n`;
                message += `**Phone:** ${order.phone}\n`;
                message += `**Payment Method:** ${order.paymentMethod === '' ? '' : ''}\n`;
                message += `**Status:** ${order.status}\n`;
                message += `**Date:** ${orderDate}\n`;

                // Add payment receipt image if available
                if (order.paymentReceipt) {
                    // Create a simple embed with just the image
                    const embed = {
                        title: "Payment Receipt",
                        image: {
                            url: order.paymentReceipt
                        },
                        color: 0x4285f4
                    };

                    // Create webhook payload
                    const payload = {
                        content: message,
                        embeds: [embed]
                    };

                    // Check if the total payload exceeds Discord's limits
                    const payloadString = JSON.stringify(payload);
                    if (payloadString.length > 2000) {
                        // If it's too long, send without the image
                        delete payload.embeds;
                    }

                    // Log the payload for debugging
                    console.log('Webhook URL:', webhookUrl);
                    console.log('Sending webhook payload length:', JSON.stringify(payload).length);

                    // Validate payload before sending
                    if (!payload.content) {
                        console.error('Invalid payload: content is empty');
                        reject(new Error('Invalid payload: content is empty'));
                        return;
                    }

                    // Send webhook with better error handling
                    fetch(webhookUrl, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify(payload)
                    })
                        .then(response => {
                            console.log('Webhook response status:', response.status);

                            if (response.ok) {
                                console.log('Webhook sent successfully');
                                resolve();
                            } else {
                                // Try to get more error details
                                response.text().then(text => {
                                    console.error('Failed to send webhook. Status:', response.status, 'Response:', text);

                                    // Check if it's a character limit error
                                    if (text.includes('2000') || text.includes('character') || text.includes('too long')) {
                                        reject(new Error('Discord message exceeds character limit (2000 chars).'));
                                    } else {
                                        reject(new Error(`Webhook failed with status ${response.status}: ${text}`));
                                    }
                                }).catch(textError => {
                                    console.error('Failed to read response text:', textError);
                                    reject(new Error(`Webhook failed with status ${response.status}`));
                                });
                            }
                        })
                        .catch(error => {
                            console.error('Error sending webhook:', error);
                            reject(error);
                        });
                } else {
                    // No image, send just the message
                    const payload = {
                        content: message
                    };

                    // Log the payload for debugging
                    console.log('Webhook URL:', webhookUrl);
                    console.log('Sending webhook payload length:', JSON.stringify(payload).length);

                    // Send webhook with better error handling
                    fetch(webhookUrl, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify(payload)
                    })
                        .then(response => {
                            console.log('Webhook response status:', response.status);

                            if (response.ok) {
                                console.log('Webhook sent successfully');
                                resolve();
                            } else {
                                // Try to get more error details
                                response.text().then(text => {
                                    console.error('Failed to send webhook. Status:', response.status, 'Response:', text);

                                    // Check if it's a character limit error
                                    if (text.includes('2000') || text.includes('character') || text.includes('too long')) {
                                        reject(new Error('Discord message exceeds character limit (2000 chars).'));
                                    } else {
                                        reject(new Error(`Webhook failed with status ${response.status}: ${text}`));
                                    }
                                }).catch(textError => {
                                    console.error('Failed to read response text:', textError);
                                    reject(new Error(`Webhook failed with status ${response.status}`));
                                });
                            }
                        })
                        .catch(error => {
                            console.error('Error sending webhook:', error);
                            reject(error);
                        });
                }
            });
        }

        // Updated submit order function with better error handling
        function submitOrderWithReceipt() {
            if (!uploadedImageFile) {
                showNotification('Please upload a payment receipt', 'error');
                return;
            }

            console.log("=== SUBMIT ORDER DEBUG ===");
            console.log("currentUser:", currentUser);
            console.log("currentUser.uid:", currentUser ? currentUser.uid : "NO USER");

            // Check if user is authenticated
            if (!currentUser) {
                console.log("ERROR: No current user");
                showNotification('Please login to place an order', 'error');
                return;
            }

            if (!currentUser.uid) {
                console.log("ERROR: User has no UID");
                showNotification('Authentication error. Please login again.', 'error');
                return;
            }

            const username = document.getElementById('username').value;
            const email = document.getElementById('email').value;
            const phone = document.getElementById('phone').value;
            const gamepassLink = currentItem.category === 'bloxfruits' ? '' : document.getElementById('gamepassLinkInput').value;

            console.log("Form data:", { username, email, phone, gamepassLink });

            // Show spinner
            document.getElementById('uploadSpinner').style.display = 'block';
            document.getElementById('submitUploadBtn').disabled = true;

            // Convert image to base64 for storage
            const reader = new FileReader();
            reader.onload = function (e) {
                const base64Image = e.target.result;

                // Create order object with proper timestamp
                const order = {
                    product: currentItem.name,
                    price: currentItem.price,
                    category: currentItem.category,
                    username,
                    email,
                    phone,
                    gamepassLink,
                    paymentMethod: selectedPaymentMethod,
                    status: 'pending',
                    createdAt: serverTimestamp(),
                    userId: currentUser.uid,
                    paymentReceipt: base64Image
                };

                console.log("Order object to save:", order);

                // Add order to Firestore
                db.collection('orders').add(order)
                    .then(docRef => {
                        console.log("SUCCESS: Order created with ID:", docRef.id);

                        // Add the ID to the order object for webhook and confirmation
                        order.id = docRef.id;

                        // Send Discord webhook notification
                        sendDiscordWebhook(order).then(() => {
                            console.log("Webhook sent successfully");
                            showNotification('Order placed successfully! Discord notification sent.', 'success');
                        }).catch(error => {
                            console.error("Error sending webhook:", error);
                            // Show detailed error message
                            const errorMessage = error.message || 'Unknown error';
                            showNotification(`Order placed but notification failed to send: ${errorMessage}`, 'warning');

                            // Show additional error details in console for debugging
                            console.error('Webhook error details:', {
                                name: error.name,
                                message: error.message,
                                stack: error.stack
                            });
                        }).finally(() => {
                            // Update UI regardless of webhook status
                            document.getElementById('uploadSpinner').style.display = 'none';
                            document.getElementById('submitUploadBtn').disabled = false;

                            // Show confirmation
                            document.getElementById('paymentUploadSection').style.display = 'none';
                            document.getElementById('orderConfirmation').style.display = 'block';

                            // Update confirmation details
                            document.getElementById('conf-product').textContent = currentItem.name;
                            document.getElementById('conf-price').textContent = currentItem.price + ' EGP';
                            document.getElementById('conf-username').textContent = username;
                            document.getElementById('conf-email').textContent = email;
                            document.getElementById('conf-phone').textContent = phone;
                            document.getElementById('conf-gamepass').textContent = gamepassLink || 'N/A';

                            // Load updated order history
                            loadOrderHistory();
                        });
                    })
                    .catch(error => {
                        console.error("ERROR: Submitting order:", error);
                        document.getElementById('uploadSpinner').style.display = 'none';
                        document.getElementById('submitUploadBtn').disabled = false;

                        // Check if it's a permission error
                        if (error.message.includes('Missing or insufficient permissions')) {
                            showNotification('Permission error. Please check Firestore security rules.', 'error');
                        } else {
                            showNotification('Error placing order: ' + error.message, 'error');
                        }
                    });
            };
            reader.readAsDataURL(uploadedImageFile);
        }

        function loadOrderHistory() {
            const orderList = document.getElementById('orderList');

            if (!currentUser) {
                orderList.innerHTML = `
                    <div class="empty-orders">
                        <i class="fas fa-receipt"></i>
                        <h3>Please login to view your order history</h3>
                        <p>Login to see your previous orders.</p>
                    </div>
                `;
                return;
            }

            // Show loading state
            orderList.innerHTML = `
                <div class="spinner"></div>
                <p style="text-align: center; margin-top: 20px;">Loading your orders...</p>
            `;

            // Get orders from Firestore
            db.collection('orders')
                .where('userId', '==', currentUser.uid)
                .orderBy('createdAt', 'desc')
                .get()
                .then(snapshot => {
                    if (snapshot.empty) {
                        orderList.innerHTML = `
                            <div class="empty-orders">
                                <i class="fas fa-receipt"></i>
                                <h3>No orders yet</h3>
                                <p>Your order history will appear here once you make a purchase.</p>
                            </div>
                        `;
                        return;
                    }

                    // Display orders
                    orderList.innerHTML = snapshot.docs.map(doc => {
                        const order = doc.data();
                        const orderDate = order.createdAt ? new Date(order.createdAt.toDate()).toLocaleDateString() : 'N/A';
                        const orderTime = order.createdAt ? new Date(order.createdAt.toDate()).toLocaleTimeString() : '';

                        return `
                            <div class="order-item">
                                <div class="order-header">
                                    <div class="order-id">${doc.id}</div>
                                    <div class="order-date">${orderDate} ${orderTime}</div>
                                    <div class="order-status ${order.status === 'completed' ? 'status-completed' : 'status-pending'}">
                                        ${order.status === 'completed' ? 'Completed' : 'Pending'}
                                    </div>
                                </div>
                                <div class="order-details-grid">
                                    <div class="order-detail-item">
                                        <div class="order-detail-label">Product</div>
                                        <div class="order-detail-value">${order.product}</div>
                                    </div>
                                    <div class="order-detail-item">
                                        <div class="order-detail-label">Price</div>
                                        <div class="order-detail-value">${order.price} EGP</div>
                                    </div>
                                    <div class="order-detail-item">
                                        <div class="order-detail-label">Payment Method</div>
                                        <div class="order-detail-value">${order.paymentMethod === '' ? '' : ''}</div>
                                    </div>
                                    <div class="order-detail-item">
                                        <div class="order-detail-label">Status</div>
                                        <div class="order-detail-value">${order.status === 'completed' ? 'Completed' : 'Pending'}</div>
                                    </div>
                                </div>
                            </div>
                        `;
                    }).join('');
                })
                .catch(error => {
                    console.error('Error loading orders:', error);
                    let errorMessage = error.message;

                    // Check if it's a missing index error
                    if (error.message.includes('The query requires an index')) {
                        errorMessage = `
                            <div class="index-error-box">
                                <h3><i class="fas fa-exclamation-triangle"></i> Database Index Required</h3>
                                <p>The database requires an index to be created to load your orders.</p>
                                <p>Please click the button below to create the required index:</p>
                                <button class="btn" onclick="openSocialOrderModal()">Create Index</button>
                                <p style="margin-top: 15px;">After creating the index, please wait a few minutes for it to be built, then <button class="btn btn-small" onclick="openSocialOrderModal()">Retry</button></p>
                            </div>
                        `;
                    }

                    orderList.innerHTML = `
                        <div class="empty-orders">
                            <i class="fas fa-exclamation-triangle"></i>
                            <h3>Error loading orders</h3>
                            <div>${errorMessage}</div>
                        </div>
                    `;
                });
        }

        function openUserSettings() {
            document.getElementById('user-settings-modal').classList.add('active');

            // Fetch the latest user data from Firestore
            db.collection('users').doc(currentUser.uid).get()
                .then(doc => {
                    if (doc.exists) {
                        const userData = doc.data();
                        // Update the currentUser object with the latest data
                        currentUser = { ...currentUser, ...userData };

                        // Update localStorage
                        localStorage.setItem('egyptGameStoreUser', JSON.stringify(currentUser));

                        // Load user data into form
                        document.getElementById('settingsName').value = currentUser.name || '';
                        document.getElementById('settingsEmail').value = currentUser.email || '';
                        document.getElementById('settingsPhone').value = currentUser.phone || '';
                    }
                })
                .catch(error => {
                    console.error('Error fetching user data:', error);
                    // Fallback to current user data
                    document.getElementById('settingsName').value = currentUser.name || '';
                    document.getElementById('settingsEmail').value = currentUser.email || '';
                    document.getElementById('settingsPhone').value = currentUser.phone || '';
                });
        }

        function closeUserSettings() {
            document.getElementById('user-settings-modal').classList.remove('active');
        }

        function switchSettingsTab(tab) {
            const profileForm = document.getElementById('profileForm');
            const securityForm = document.getElementById('securityForm');
            const settingsTabs = document.querySelectorAll('.settings-tab');

            settingsTabs.forEach(t => t.classList.remove('active'));

            if (tab === 'profile') {
                settingsTabs[0].classList.add('active');
                profileForm.classList.add('active');
                securityForm.classList.remove('active');
            } else {
                settingsTabs[1].classList.add('active');
                securityForm.classList.add('active');
                profileForm.classList.remove('active');
            }
        }

        // Fixed updateUserProfile function
        function updateUserProfile() {
            const name = document.getElementById('settingsName').value;
            const email = document.getElementById('settingsEmail').value;
            const phone = document.getElementById('settingsPhone').value;

            if (!name || !email) {
                showNotification('Name and email are required', 'error');
                return;
            }

            // Show loading state
            const saveButton = document.querySelector('.btn-save');
            const originalText = saveButton.textContent;
            saveButton.textContent = 'Saving...';
            saveButton.disabled = true;

            // Use set with merge instead of update to create document if it doesn't exist
            db.collection('users').doc(currentUser.uid).set({
                name: name,
                email: email,
                phone: phone
            }, { merge: true })
                .then(() => {
                    // Update Firebase Auth user profile (display name)
                    return window.updateProfile(window.auth.currentUser, {
                        displayName: name
                    });
                })
                .then(() => {
                    // Update the local currentUser object
                    currentUser.name = name;
                    currentUser.email = email;
                    currentUser.phone = phone;

                    // Update localStorage
                    localStorage.setItem('egyptGameStoreUser', JSON.stringify(currentUser));

                    // Force refresh of user data from Firebase
                    return auth.currentUser.reload();
                })
                .then(() => {
                    // Get fresh user data from Firestore
                    return db.collection('users').doc(currentUser.uid).get();
                })
                .then(doc => {
                    if (doc.exists) {
                        const userData = doc.data();
                        // Update currentUser with fresh data
                        currentUser = { ...currentUser, ...userData };

                        // Update localStorage with fresh data
                        localStorage.setItem('egyptGameStoreUser', JSON.stringify(currentUser));

                        // Update UI with fresh data
                        updateUserMenu();

                        // Close settings modal
                        closeUserSettings();

                        showNotification('Profile updated successfully', 'success');
                    }
                })
                .catch(error => {
                    console.error('Error updating profile:', error);

                    // Check if it's a permission error
                    if (error.message.includes('Missing or insufficient permissions')) {
                        showNotification('Permission error. Please check Firestore security rules.', 'error');
                    } else {
                        showNotification('Error updating profile: ' + error.message, 'error');
                    }
                })
                .finally(() => {
                    // Reset button state
                    saveButton.textContent = originalText;
                    saveButton.disabled = false;
                });
        }

        function changePassword() {
            const currentPassword = document.getElementById('currentPassword').value;
            const newPassword = document.getElementById('newPassword').value;
            const confirmPassword = document.getElementById('confirmNewPassword').value;

            if (!currentPassword || !newPassword || !confirmPassword) {
                showNotification('Please fill in all password fields', 'error');
                return;
            }

            if (newPassword !== confirmPassword) {
                showNotification('New passwords do not match', 'error');
                return;
            }

            if (newPassword.length < 6) {
                showNotification('Password must be at least 6 characters', 'error');
                return;
            }

            // Re-authenticate user first
            const credential = EmailAuthProvider.credential(
                currentUser.email,
                currentPassword
            );

            reauthenticateWithCredential(currentUser, credential)
                .then(() => {
                    // Update password
                    return updatePassword(currentUser, newPassword);
                })
                .then(() => {
                    // Reset form
                    document.getElementById('securityForm').reset();

                    showNotification('Password changed successfully', 'success');
                })
                .catch(error => {
                    console.error('Error changing password:', error);

                    // Handle specific Firebase auth errors
                    if (error.code === 'auth/wrong-password') {
                        showNotification('Incorrect current password. Please try again.', 'error');
                    } else if (error.code === 'auth/user-mismatch') {
                        showNotification('Authentication error. Please login again.', 'error');
                    } else {
                        showNotification('Error changing password: ' + error.message, 'error');
                    }
                });
        }

        // Admin Panel Functions
        function showAdminLogin() {
            console.log('showAdminLogin called, currentUserAdmin:', currentUserAdmin);
            console.log('currentUserAdmin email:', currentUserAdmin?.email);
            
            // Check if current user is admin (your Google emails)
            const adminEmails = ['mohamedmagdyroblox@gmail.com', 'shadowbr500@gmail.com'];
            if (currentUserAdmin && adminEmails.includes(currentUserAdmin.email)) {
                console.log('User is admin - opening admin panel directly');
                // User is admin - directly open admin panel
                isAdminLoggedIn = true;
                localStorage.setItem('egyptGameStoreAdminLoggedIn', 'true');
                document.getElementById('adminPanel').classList.add('active');
                loadAdminData();
            } else {
                console.log('User is not admin - showing login modal');
                // User is not admin - show login modal
                document.getElementById('adminLogin').classList.add('active');
            }
        }

        function closeAdminLogin() {
            document.getElementById('adminLogin').classList.remove('active');
        }

        function adminLogin() {
            const email = document.getElementById('adminEmail').value;

            // Check if email is admin email
            if (email === 'admin@egyptgameshop.com') {
                isAdminLoggedIn = true;
                localStorage.setItem('egyptGameStoreAdminLoggedIn', 'true');

                // Close login modal
                closeAdminLogin();

                // Load admin data
                loadAdminData();

                // Show admin panel
                document.getElementById('adminPanel').classList.add('active');

                showNotification('Admin login successful', 'success');
            } else {
                showNotification('Incorrect admin password', 'error');
            }
        }

        function closeAdminPanel() {
            // Just close the admin panel without logging out
            document.getElementById('adminPanel').classList.remove('active');
        }

        function logoutAdmin() {
            isAdminLoggedIn = false;
            localStorage.removeItem('egyptGameStoreAdminLoggedIn');

            // Hide admin panel
            document.getElementById('adminPanel').classList.remove('active');

            showNotification('Admin logged out', 'info');
        }

        function switchAdminTab(tab) {
            const dashboardContent = document.getElementById('dashboard-content');
            const productsContent = document.getElementById('products-content');
            const usersContent = document.getElementById('users-content');
            const ordersContent = document.getElementById('orders-content');
            const webhookContent = document.getElementById('webhook-content');
            const rulesContent = document.getElementById('rules-content');
            const adminTabs = document.querySelectorAll('.admin-tab');

            adminTabs.forEach(t => t.classList.remove('active'));

            // Hide all content
            dashboardContent.classList.remove('active');
            productsContent.classList.remove('active');
            usersContent.classList.remove('active');
            ordersContent.classList.remove('active');
            webhookContent.classList.remove('active');
            rulesContent.classList.remove('active');

            // Show selected content
            if (tab === 'dashboard') {
                adminTabs[0].classList.add('active');
                dashboardContent.classList.add('active');
            } else if (tab === 'products') {
                adminTabs[1].classList.add('active');
                productsContent.classList.add('active');
                loadProductsTable();
            } else if (tab === 'users') {
                adminTabs[2].classList.add('active');
                usersContent.classList.add('active');
                loadUsersTable();
            } else if (tab === 'orders') {
                adminTabs[3].classList.add('active');
                ordersContent.classList.add('active');
                loadOrdersTable();
            } else if (tab === 'webhook') {
                adminTabs[4].classList.add('active');
                webhookContent.classList.add('active');
            } else if (tab === 'rules') {
                adminTabs[5].classList.add('active');
                rulesContent.classList.add('active');
            }
        }

        function loadAdminData() {
            if (!isAdminLoggedIn) {
                console.log('Access denied: User is not an admin');
                return;
            }

            // Get data from Firestore
            Promise.all([
                getDocs(collection(window.db, 'users')),
                getDocs(collection(window.db, 'orders'))
            ]).then(([usersSnapshot, ordersSnapshot]) => {
                const users = usersSnapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                const orders = ordersSnapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));

                // Calculate stats
                const totalRevenue = orders.reduce((sum, order) => sum + parseInt(order.price || 0), 0);
                const pendingOrders = orders.filter(order => order.status === 'pending').length;

                // Update stats
                document.getElementById('totalUsers').textContent = users.length;
            }).catch(error => {
                console.error('Error loading admin data:', error);
                let errorMessage = error.message;

                // Check if it's a permission error
                if (error.message.includes('Missing or insufficient permissions')) {
                    errorMessage = `
                        <div class="error-box">
                            <h3><i class="fas fa-exclamation-triangle"></i> Firebase Security Rules Error</h3>
                            <p>Your Firebase security rules are preventing access to the database.</p>
                            <p>Please update your Firestore security rules to allow read/write access.</p>
                            <p>You can use these rules for testing:</p>
                            <pre>rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    match /{document=**} {
      allow read, write: if true;
    }
  }
}</pre>
                            <p>For production, you should implement more restrictive rules.</p>
                            <button class="btn" onclick="openSocialOrderModal()">Open Firebase Console</button>
                            <button class="btn btn-small" onclick="openSocialOrderModal()" style="margin-left: 10px;">Retry</button>
                        </div>
                    `;
                }

                // Show error in admin panel
                document.getElementById('totalUsers').textContent = 'Error';

                // Create a notification area
                const dashboardContent = document.getElementById('dashboard-content');
                const existingError = dashboardContent.querySelector('.error-box');
                if (!existingError) {
                    const errorDiv = document.createElement('div');
                    errorDiv.className = 'error-box';
                    errorDiv.innerHTML = errorMessage;
                    dashboardContent.insertBefore(errorDiv, dashboardContent.firstChild);
                }

                showNotification('Error loading admin data: ' + error.message, 'error');
            });
        }

        function clearRevenueData() {
            if (confirm('Are you sure you want to clear all revenue data? This will reset the total revenue to 0 but keep all orders.')) {
                // Get orders
                getDocs(collection(window.db, 'orders'))
                    .then(snapshot => {
                        const batch = writeBatch(window.db);
                        snapshot.docs.forEach(doc => {
                            batch.update(doc.ref, { price: 0 });
                        });
                        return batch.commit();
                    })
                    .then(() => {
                        // Reload admin data
                        loadAdminData();

                        // Reload orders table if visible
                        if (document.getElementById('orders-content').classList.contains('active')) {
                            loadOrdersTable();
                        }

                        showNotification('Revenue data cleared successfully', 'success');
                    })
                    .catch(error => {
                        console.error('Error clearing revenue data:', error);

                        // Check if it's a permission error
                        if (error.message.includes('Missing or insufficient permissions')) {
                            showNotification('Permission error. Please check Firestore security rules.', 'error');
                        } else {
                            showNotification('Error clearing revenue data', 'error');
                        }
                    });
            }
        }

        function clearPendingOrders() {
            if (confirm('Are you sure you want to delete all pending orders? This action cannot be undone.')) {
                // Get pending orders
                db.collection('orders')
                    .where('status', '==', 'pending')
                    .get()
                    .then(snapshot => {
                        if (snapshot.empty) {
                            showNotification('No pending orders to clear', 'info');
                            return;
                        }
                        const batch = db.batch();
                        snapshot.docs.forEach(doc => {
                            batch.delete(doc.ref);
                        });
                        return batch.commit();
                    })
                    .then(() => {
                        // Reload admin data
                        loadAdminData();

                        // Reload orders table if visible
                        if (document.getElementById('orders-content').classList.contains('active')) {
                            loadOrdersTable();
                        }

                        showNotification('Pending orders cleared successfully', 'success');
                    })
                    .catch(error => {
                        console.error('Error clearing pending orders:', error);

                        // Check if it's a permission error
                        if (error.message.includes('Missing or insufficient permissions')) {
                            showNotification('Permission error. Please check Firestore security rules.', 'error');
                        } else {
                            showNotification('Error clearing pending orders', 'error');
                        }
                    });
            }
        }

        function clearCompletedOrders() {
            if (confirm('Are you sure you want to delete all completed orders? This action cannot be undone.')) {
                // Get completed orders
                db.collection('orders')
                    .where('status', '==', 'completed')
                    .get()
                    .then(snapshot => {
                        if (snapshot.empty) {
                            showNotification('No completed orders to clear', 'info');
                            return;
                        }
                        const batch = db.batch();
                        snapshot.docs.forEach(doc => {
                            batch.delete(doc.ref);
                        });
                        return batch.commit();
                    })
                    .then(() => {
                        // Reload admin data
                        loadAdminData();

                        // Reload orders table if visible
                        if (document.getElementById('orders-content').classList.contains('active')) {
                            loadOrdersTable();
                        }

                        showNotification('Completed orders cleared successfully', 'success');
                    })
                    .catch(error => {
                        console.error('Error clearing completed orders:', error);

                        // Check if it's a permission error
                        if (error.message.includes('Missing or insufficient permissions')) {
                            showNotification('Permission error. Please check Firestore security rules.', 'error');
                        } else {
                            showNotification('Error clearing completed orders', 'error');
                        }
                    });
            }
        }

        function loadUsersTable() {
            if (!isAdminLoggedIn) {
                console.log('Access denied: User is not an admin');
                document.getElementById('usersList').innerHTML = `
                    <div class="empty-orders">
                        <i class="fas fa-exclamation-triangle"></i>
                        <h3>Access Denied</h3>
                        <p>You don't have permission to view this page.</p>
                    </div>
                `;
                return;
            }

            const usersList = document.getElementById('usersList');

            // Show loading state
            usersList.innerHTML = `
                <div class="spinner"></div>
                <p style="text-align: center; margin-top: 20px;">Loading users...</p>
            `;

            getDocs(collection(window.db, 'users'))
                .then(snapshot => {
                    if (snapshot.empty) {
                        usersList.innerHTML = `
                            <div class="empty-orders">
                                <i class="fas fa-users"></i>
                                <h3>No users found</h3>
                                <p>No users have registered yet.</p>
                            </div>
                        `;
                        return;
                    }

                    usersList.innerHTML = snapshot.docs.map(doc => {
                        const user = { id: doc.id, ...doc.data() };
                        return `
                            <div class="user-info-card">
                                <h4>${user.name} (${user.email})</h4>
                                <div class="user-info-grid">
                                    <div class="user-info-item">
                                        <div class="user-info-label">User ID</div>
                                        <div class="user-info-value">${user.id}</div>
                                    </div>
                                    <div class="user-info-item">
                                        <div class="user-info-label">Username</div>
                                        <div class="user-info-value">${user.username || 'N/A'}</div>
                                    </div>
                                    <div class="user-info-item">
                                        <div class="user-info-label">Phone</div>
                                        <div class="user-info-value">${user.phone || 'N/A'}</div>
                                    </div>
                                    <div class="user-info-item">
                                        <div class="user-info-label">Registered</div>
                                        <div class="user-info-value">${user.registeredAt ? new Date(user.registeredAt.toDate()).toLocaleDateString() : 'N/A'}</div>
                                    </div>
                                    <div class="user-info-item">
                                        <div class="user-info-label">Actions</div>
                                        <div class="user-info-value">
                                            <div class="admin-actions">
                                                <button class="btn-small btn-view" onclick="openSocialOrderModal()">
                                                    <i class="fas fa-eye"></i> View
                                                </button>
                                                <button class="btn-small btn-delete" onclick="openSocialOrderModal()">
                                                    <i class="fas fa-trash"></i> Delete
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        `;
                    }).join('');
                })
                .catch(error => {
                    console.error('Error loading users:', error);
                    usersList.innerHTML = `
                        <div class="empty-orders">
                            <i class="fas fa-exclamation-triangle"></i>
                            <h3>Error loading users</h3>
                            <p>${error.message}</p>
                        </div>
                    `;
                });
        }

        function loadOrdersTable() {
            if (!isAdminLoggedIn) {
                console.log('Access denied: User is not an admin');
                document.getElementById('ordersTableBody').innerHTML = `
                    <tr>
                        <td colspan="8" style="text-align: center; padding: 30px; color: var(--gray);">
                            Access Denied
                        </td>
                    </tr>
                `;
                return;
            }

            const ordersTableBody = document.getElementById('ordersTableBody');

            // Show loading state
            ordersTableBody.innerHTML = `
                <tr>
                    <td colspan="8" style="text-align: center; padding: 30px;">
                        <div class="spinner"></div>
                        <p style="margin-top: 10px;">Loading orders...</p>
                    </td>
                </tr>
            `;

            getDocs(query(collection(window.db, 'orders'), orderBy('createdAt', 'desc')))
                .then(snapshot => {
                    if (snapshot.empty) {
                        ordersTableBody.innerHTML = `
                            <tr>
                                <td colspan="8" style="text-align: center; padding: 30px; color: var(--gray);">
                                    No orders found
                                </td>
                            </tr>
                        `;
                        return;
                    }

                    ordersTableBody.innerHTML = snapshot.docs.map(doc => {
                        const order = doc.data();
                        const orderDate = order.createdAt ? new Date(order.createdAt.toDate()).toLocaleDateString() : 'N/A';
                        const orderTime = order.createdAt ? new Date(order.createdAt.toDate()).toLocaleTimeString() : '';

                        return `
                            <tr>
                                <td>${doc.id}</td>
                                <td>${order.username}</td>
                                <td>${order.product}</td>
                                <td>${order.price} EGP</td>
                                <td>${order.paymentMethod === '' ? '' : ''}</td>
                                <td>${orderDate} ${orderTime}</td>
                                <td>
                                    <span class="order-status ${order.status === 'completed' ? 'status-completed' : 'status-pending'}">
                                        ${order.status === 'completed' ? 'Completed' : 'Pending'}
                                    </span>
                                </td>
                                <td>
                                    <div class="admin-actions">
                                        <button class="btn-small btn-view" onclick="openSocialOrderModal()">
                                            <i class="fas fa-eye"></i> View
                                        </button>
                                        ${order.status === 'pending' ? `
                                            <button class="btn-small btn-complete" onclick="openSocialOrderModal()">
                                                <i class="fas fa-check"></i> Complete
                                            </button>
                                        ` : ''}
                                        <button class="btn-small btn-delete" onclick="openSocialOrderModal()">
                                            <i class="fas fa-trash"></i> Delete
                                        </button>
                                    </div>
                                </td>
                            </tr>
                        `;
                    }).join('');
                })
                .catch(error => {
                    console.error('Error loading orders:', error);
                    ordersTableBody.innerHTML = `
                        <tr>
                            <td colspan="8" style="text-align: center; padding: 30px; color: var(--gray);">
                                Error loading orders: ${error.message}
                            </td>
                        </tr>
                    `;
                });
        }

        function filterOrders() {
            const searchTerm = document.getElementById('orderSearch').value.toLowerCase();
            const filterStatus = document.getElementById('orderFilter').value;

            if (!isAdminLoggedIn) {
                console.log('Access denied: User is not an admin');
                return;
            }

            const ordersTableBody = document.getElementById('ordersTableBody');

            let query = db.collection('orders').orderBy('createdAt', 'desc');

            if (filterStatus !== 'all') {
                query = query.where('status', '==', filterStatus);
            }

            query.get()
                .then(snapshot => {
                    if (snapshot.empty) {
                        ordersTableBody.innerHTML = `
                            <tr>
                                <td colspan="8" style="text-align: center; padding: 30px; color: var(--gray);">
                                    No orders found
                                </td>
                            </tr>
                        `;
                        return;
                    }

                    ordersTableBody.innerHTML = snapshot.docs.map(doc => {
                        const order = doc.data();

                        // Apply search filter
                        if (searchTerm && !order.username.toLowerCase().includes(searchTerm) &&
                            !order.product.toLowerCase().includes(searchTerm) &&
                            !order.email.toLowerCase().includes(searchTerm)) {
                            return '';
                        }

                        const orderDate = order.createdAt ? new Date(order.createdAt.toDate()).toLocaleDateString() : 'N/A';
                        const orderTime = order.createdAt ? new Date(order.createdAt.toDate()).toLocaleTimeString() : '';

                        return `
                            <tr>
                                <td>${doc.id}</td>
                                <td>${order.username}</td>
                                <td>${order.product}</td>
                                <td>${order.price} EGP</td>
                                <td>${order.paymentMethod === '' ? '' : ''}</td>
                                <td>${orderDate} ${orderTime}</td>
                                <td>
                                    <span class="order-status ${order.status === 'completed' ? 'status-completed' : 'status-pending'}">
                                        ${order.status === 'completed' ? 'Completed' : 'Pending'}
                                    </span>
                                </td>
                                <td>
                                    <div class="admin-actions">
                                        <button class="btn-small btn-view" onclick="openSocialOrderModal()">
                                            <i class="fas fa-eye"></i> View
                                        </button>
                                        ${order.status === 'pending' ? `
                                            <button class="btn-small btn-complete" onclick="openSocialOrderModal()">
                                                <i class="fas fa-check"></i> Complete
                                            </button>
                                        ` : ''}
                                        <button class="btn-small btn-delete" onclick="openSocialOrderModal()">
                                            <i class="fas fa-trash"></i> Delete
                                        </button>
                                    </div>
                                </td>
                            </tr>
                        `;
                    }).join('');
                })
                .catch(error => {
                    console.error('Error loading orders:', error);
                    ordersTableBody.innerHTML = `
                        <tr>
                            <td colspan="8" style="text-align: center; padding: 30px; color: var(--gray);">
                                Error loading orders: ${error.message}
                            </td>
                        </tr>
                    `;
                });
        }

        function viewUser(userId) {
            getDoc(doc(window.db, 'users', userId))
                .then(doc => {
                    if (doc.exists) {
                        const user = { id: doc.id, ...doc.data() };

                        // Show user details in a modal
                        document.getElementById('accountDetails').classList.add('active');

                        // Populate account info
                        document.getElementById('accountInfo').innerHTML = `
                            <div class="info-item">
                                <div class="info-label">User ID</div>
                                <div class="info-value">${user.id}</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">Name</div>
                                <div class="info-value">${user.name}</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">Username</div>
                                <div class="info-value">${user.username || 'N/A'}</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">Email</div>
                                <div class="info-value">${user.email}</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">Phone</div>
                                <div class="info-value">${user.phone || 'N/A'}</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">Registered</div>
                                <div class="info-value">${user.registeredAt ? new Date(user.registeredAt.toDate()).toLocaleDateString() : 'N/A'}</div>
                            </div>
                        `;

                        // Load user orders
                        loadUserOrders(user.email);
                    }
                })
                .catch(error => {
                    console.error('Error getting user:', error);
                    showNotification('Error getting user details', 'error');
                });
        }

        function loadUserOrders(userEmail) {
            getDocs(query(collection(window.db, 'orders'), where('email', '==', userEmail)))
                .then(snapshot => {
                    const userOrdersTable = document.getElementById('userOrdersTable');

                    if (snapshot.empty) {
                        userOrdersTable.innerHTML = `
                            <tr>
                                <td colspan="5" style="text-align: center; padding: 30px; color: var(--gray);">
                                    No orders found for this user
                                </td>
                            </tr>
                        `;
                        return;
                    }

                    // Sort orders by createdAt in descending order (newest first)
                    const sortedDocs = snapshot.docs.sort((a, b) => {
                        const aTime = a.data().createdAt ? a.data().createdAt.toDate().getTime() : 0;
                        const bTime = b.data().createdAt ? b.data().createdAt.toDate().getTime() : 0;
                        return bTime - aTime; // Descending order (newest first)
                    });

                    userOrdersTable.innerHTML = sortedDocs.map(doc => {
                        const order = doc.data();
                        const orderDate = order.createdAt ? new Date(order.createdAt.toDate()).toLocaleDateString() : 'N/A';
                        const orderTime = order.createdAt ? new Date(order.createdAt.toDate()).toLocaleTimeString() : '';

                        return `
                            <tr>
                                <td>${doc.id}</td>
                                <td>${order.product}</td>
                                <td>${order.price} EGP</td>
                                <td>${orderDate} ${orderTime}</td>
                                <td>
                                    <span class="order-status ${order.status === 'completed' ? 'status-completed' : 'status-pending'}">
                                        ${order.status === 'completed' ? 'Completed' : 'Pending'}
                                    </span>
                                </td>
                            </tr>
                        `;
                    }).join('');
                })
                .catch(error => {
                    console.error('Error loading user orders:', error);
                    document.getElementById('userOrdersTable').innerHTML = `
                        <tr>
                            <td colspan="5" style="text-align: center; padding: 30px; color: var(--gray);">
                                Error loading orders: ${error.message}
                            </td>
                        </tr>
                    `;
                });
        }

        function deleteUser(userId) {
            deleteTarget = userId;
            deleteType = 'user';
            document.getElementById('deleteConfirmation').classList.add('active');
        }

        function viewOrder(orderId) {
            // Hide admin panel temporarily
            const adminPanel = document.getElementById('adminPanel');
            adminPanel.style.display = 'none';

            db.collection('orders').doc(orderId).get()
                .then(doc => {
                    if (doc.exists) {
                        const order = { id: doc.id, ...doc.data() };

                        // Show order details in a modal
                        document.getElementById('orderDetailsModal').classList.add('active');

                        // Populate order info
                        document.getElementById('orderInfo').innerHTML = `
                            <div class="order-info-item">
                                <div class="order-info-label">Order ID</div>
                                <div class="order-info-value">${order.id}</div>
                            </div>
                            <div class="order-info-item">
                                <div class="order-info-label">Product</div>
                                <div class="order-info-value">${order.product}</div>
                            </div>
                            <div class="order-info-item">
                                <div class="order-info-label">Price</div>
                                <div class="order-info-value">${order.price} EGP</div>
                            </div>
                            <div class="order-info-item">
                                <div class="order-info-label">Customer</div>
                                <div class="order-info-value">${order.username}</div>
                            </div>
                            <div class="order-info-item">
                                <div class="order-info-label">Email</div>
                                <div class="order-info-value">${order.email}</div>
                            </div>
                            <div class="order-info-item">
                                <div class="order-info-label">Phone</div>
                                <div class="order-info-value">${order.phone}</div>
                            </div>
                            <div class="order-info-item">
                                <div class="order-info-label">Payment Method</div>
                                <div class="order-info-value">${order.paymentMethod === '' ? '' : ''}</div>
                            </div>
                            <div class="order-info-item">
                                <div class="order-info-label">Status</div>
                                <div class="order-info-value">${order.status === 'completed' ? 'Completed' : 'Pending'}</div>
                            </div>
                            <div class="order-info-item">
                                <div class="order-info-label">Date</div>
                                <div class="order-info-value">${order.createdAt ? new Date(order.createdAt.toDate()).toLocaleDateString() : 'N/A'}</div>
                            </div>
                            
                            ${order.paymentReceipt ? `
                            <div class="order-info-item">
                                <div class="order-info-label">Payment Receipt</div>
                                <div class="order-info-value">
                                    <img src="${order.paymentReceipt}" alt="Payment Receipt" style="max-width: 200px; max-height: 150px; border-radius: 8px; cursor: pointer;" onclick="openSocialOrderModal()">
                                </div>
                            </div>
                            ` : ''}
                        `;
                    }
                })
                .catch(error => {
                    console.error('Error getting order:', error);
                    showNotification('Error getting order details', 'error');
                });
        }

        function completeOrder(orderId) {
            db.collection('orders').doc(orderId).update({
                status: 'completed'
            })
                .then(() => {
                    // Reload table
                    loadOrdersTable();

                    // Update stats
                    loadAdminData();

                    showNotification('Order marked as completed', 'success');
                })
                .catch(error => {
                    console.error('Error completing order:', error);

                    // Check if it's a permission error
                    if (error.message.includes('Missing or insufficient permissions')) {
                        showNotification('Permission error. Please check Firestore security rules.', 'error');
                    } else {
                        showNotification('Error completing order', 'error');
                    }
                });
        }

        function deleteOrder(orderId) {
            deleteTarget = orderId;
            deleteType = 'order';
            document.getElementById('deleteConfirmation').classList.add('active');
        }

        function cancelDelete() {
            document.getElementById('deleteConfirmation').classList.remove('active');
            deleteTarget = null;
            deleteType = null;
        }

        function confirmDelete() {
            if (deleteType === 'user') {
                deleteDoc(doc(window.db, 'users', deleteTarget))
                    .then(() => {
                        // Reload table
                        loadUsersTable();

                        // Update stats
                        loadAdminData();

                        showNotification('User deleted successfully', 'success');
                    })
                    .catch(error => {
                        console.error('Error deleting user:', error);

                        // Check if it's a permission error
                        if (error.message.includes('Missing or insufficient permissions')) {
                            showNotification('Permission error. Please check Firestore security rules.', 'error');
                        } else {
                            showNotification('Error deleting user: ' + error.message, 'error');
                        }
                    });
            } else if (deleteType === 'order') {
                db.collection('orders').doc(deleteTarget).delete()
                    .then(() => {
                        // Reload table
                        loadOrdersTable();

                        // Update stats
                        loadAdminData();

                        showNotification('Order deleted successfully', 'success');
                    })
                    .catch(error => {
                        console.error('Error deleting order:', error);

                        // Check if it's a permission error
                        if (error.message.includes('Missing or insufficient permissions')) {
                            showNotification('Permission error. Please check Firestore security rules.', 'error');
                        } else {
                            showNotification('Error deleting order: ' + error.message, 'error');
                        }
                    });
            }

            // Close confirmation modal
            cancelDelete();
        }

        function closeAccountDetails() {
            document.getElementById('accountDetails').classList.remove('active');
        }

        function closeOrderDetailsModal() {
            document.getElementById('orderDetailsModal').classList.remove('active');

            // Show admin panel again if it was open
            if (isAdminLoggedIn) {
                document.getElementById('adminPanel').style.display = 'block';
            }
        }

        // Webhook Functions
        function loadWebhookSettings() {
            // Use the correct webhook URL
            const webhookUrl = "https://discord.com/api/webhooks/1412244202024075485/kXO3zpjgJBaz4sXzqKN_pue4BAiyumGJPMuz-Ra2S4m-f79D5VPS5ytggnIv3iI4mA68";

            // Save to localStorage
            localStorage.setItem('egyptGameStoreWebhookUrl', webhookUrl);

            // Update UI
            document.getElementById('webhookUrl').value = webhookUrl;
            document.getElementById('webhookStatus').textContent = 'Webhook configured';
            document.getElementById('webhookStatus').style.color = 'var(--success)';

            console.log('Webhook URL loaded:', webhookUrl);
        }

        function saveWebhookSettings() {
            const webhookUrl = document.getElementById('webhookUrl').value;

            if (webhookUrl) {
                localStorage.setItem('egyptGameStoreWebhookUrl', webhookUrl);
                document.getElementById('webhookStatus').textContent = 'Webhook configured';
                document.getElementById('webhookStatus').style.color = 'var(--success)';
                showNotification('Webhook settings saved', 'success');
            } else {
                localStorage.removeItem('egyptGameStoreWebhookUrl');
                document.getElementById('webhookStatus').textContent = 'Webhook not configured';
                document.getElementById('webhookStatus').style.color = 'var(--gray)';
                showNotification('Webhook settings cleared', 'info');
            }
        }

        function testWebhook() {
            const webhookUrl = localStorage.getItem('egyptGameStoreWebhookUrl') ||
                "https://discord.com/api/webhooks/1412244202024075485/kXO3zpjgJBaz4sXzqKN_pue4BAiyumGJPMuz-Ra2S4m-f79D5VPS5ytggnIv3iI4mA68";

            if (!webhookUrl) {
                showNotification('Please configure a webhook URL first', 'error');
                return;
            }

            // Create test embed object
            const embed = {
                title: "EgyptGameShop - Test",
                description: "This is a test notification from EgyptGameShop",
                color: 0x4285f4,
                timestamp: new Date().toISOString()
            };

            // Create test webhook payload
            const payload = {
                content: "🔔 **Test Notification**",
                embeds: [embed]
            };

            // Show loading state
            const testBtn = event.target;
            const originalText = testBtn.textContent;
            testBtn.textContent = 'Sending...';
            testBtn.disabled = true;

            console.log('Testing webhook with URL:', webhookUrl);
            console.log('Test payload:', JSON.stringify(payload));

            // Send webhook
            fetch(webhookUrl, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(payload)
            })
                .then(response => {
                    console.log('Webhook response status:', response.status);

                    if (response.ok) {
                        showNotification('Test notification sent successfully!', 'success');
                    } else {
                        response.text().then(text => {
                            console.error('Failed to send test webhook. Status:', response.status, 'Response:', text);
                            showNotification(`Failed to send test notification: ${text}`, 'error');
                        });
                    }
                })
                .catch(error => {
                    console.error('Error sending test webhook:', error);
                    showNotification('Error sending test notification: ' + error.message, 'error');
                })
                .finally(() => {
                    // Reset button state
                    testBtn.textContent = originalText;
                    testBtn.disabled = false;
                });
        }

        // Direct test function for webhook (can be run from console)
        function testWebhookDirectly() {
            const webhookUrl = "https://discord.com/api/webhooks/1412244202024075485/kXO3zpjgJBaz4sXzqKN_pue4BAiyumGJPMuz-Ra2S4m-f79D5VPS5ytggnIv3iI4mA68";

            const testPayload = {
                content: "🔔 **Direct Test Notification from EgyptGameShop**",
                embeds: [{
                    title: "Direct Webhook Test",
                    description: "This is a direct test notification to verify the webhook is working correctly.",
                    color: 0x4285f4,
                    fields: [
                        { name: "Test Field 1", value: "Test Value 1", inline: true },
                        { name: "Test Field 2", value: "Test Value 2", inline: true }
                    ],
                    footer: {
                        text: "EgyptGameShop Direct Test"
                    },
                    timestamp: new Date().toISOString()
                }]
            };

            console.log('Testing webhook with URL:', webhookUrl);
            console.log('Test payload:', JSON.stringify(testPayload));

            fetch(webhookUrl, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(testPayload)
            })
                .then(response => {
                    console.log('Webhook response status:', response.status);

                    if (response.ok) {
                        console.log('✅ Webhook test successful!');
                        showNotification('Direct webhook test successful!', 'success');
                    } else {
                        response.text().then(text => {
                            console.error('❌ Webhook test failed. Status:', response.status, 'Response:', text);
                            showNotification(`Webhook test failed: ${text}`, 'error');
                        });
                    }
                })
                .catch(error => {
                    console.error('❌ Error testing webhook:', error);
                    showNotification('Error testing webhook: ' + error.message, 'error');
                });
        }

        // Forgot Password Functions
        function showForgotPassword() {
            // Close auth dropdown
            toggleAuthDropdown();

            // Show forgot password modal
            document.getElementById('forgotPasswordModal').classList.add('active');
        }

        function closeForgotPassword() {
            document.getElementById('forgotPasswordModal').classList.remove('active');
        }

        function showLoginFromForgotPassword() {
            closeForgotPassword();
            toggleAuthDropdown();
        }

        function resetPassword() {
            const email = document.getElementById('forgotEmail').value;

            if (!email) {
                showNotification('Please enter your email address', 'error');
                return;
            }

            // Show loading state
            const resetBtn = document.querySelector('.forgot-password-form + .admin-btn');
            const originalText = resetBtn.textContent;
            resetBtn.textContent = 'Sending...';
            resetBtn.disabled = true;

            // Send password reset email
            auth.sendPasswordResetEmail(email)
                .then(() => {
                    showNotification('Password reset email sent. Please check your inbox.', 'success');
                    closeForgotPassword();
                    document.getElementById('forgotEmail').value = '';
                })
                .catch(error => {
                    console.error('Error sending password reset email:', error);

                    // Handle specific Firebase auth errors
                    if (error.code === 'auth/user-not-found') {
                        showNotification('No account found with this email address.', 'error');
                    } else if (error.code === 'auth/invalid-email') {
                        showNotification('Invalid email address. Please enter a valid email.', 'error');
                    } else if (error.code === 'auth/too-many-requests') {
                        showNotification('Too many requests. Please try again later.', 'error');
                    } else {
                        showNotification('Error sending password reset email: ' + error.message, 'error');
                    }
                })
                .finally(() => {
                    // Reset button state
                    resetBtn.textContent = originalText;
                    resetBtn.disabled = false;
                });
        }

        // Function to close Discord banner - disabled since we removed the close button
        function closeDiscordBanner() {
            // This function is intentionally left empty since we removed the close button
            // The banner will always be visible now
        }

        // Check if banner should be hidden on page load - disabled since banner is always visible
        document.addEventListener('DOMContentLoaded', function () {
            // Banner will always be visible now, so no need to check localStorage
        });
    </script>

    <script>
        /* Category switching (prevents bleed between sections) */
        (function(){
        const tabs = document.querySelectorAll('.category-tab');
        const robux = document.getElementById('robux-products');
        const fruitsWrap = document.getElementById('bloxfruits-container');
        const mm2 = document.getElementById('mm2-products');
        const garden = document.getElementById('garden-products');
        const robuxWarning = document.getElementById('robux-warning'); // if you show a Robux-only notice
        
        function show(cat){
            // hide all
            if (robux) robux.style.display = 'none';
            if (fruitsWrap) fruitsWrap.style.display = 'none';
            if (mm2) mm2.style.display = 'none';
            if (garden) garden.style.display = 'none';
            // show one
            if (cat === 'robux' && robux) robux.style.display = '';
            if (cat === 'bloxfruits' && fruitsWrap) fruitsWrap.style.display = '';
            if (cat === 'mm2' && mm2) mm2.style.display = '';
            if (cat === 'garden' && garden) garden.style.display = '';
            // optional robux-only notice
            if (robuxWarning) robuxWarning.style.display = (cat === 'robux') ? '' : 'none';
        }
        
        tabs.forEach(t=>{
            t.addEventListener('click', ()=>{
            tabs.forEach(x=>x.classList.remove('active'));
            t.classList.add('active');
            show(t.getAttribute('data-category'));
            });
        });
        
        // Internal Blox Fruits toggle
        window.showBloxfruitsGamepasses = function(){
            const a = document.getElementById('bloxfruits-products');
            const b = document.getElementById('bloxfruits-permanent-fruits');
            document.getElementById('gamepasses-btn')?.classList.add('active');
            document.getElementById('permanent-fruits-btn')?.classList.remove('active');
            if(a) a.style.display = ''; if(b) b.style.display = 'none';
        };
        window.showBloxfruitsPermanentFruits = function(){
            const a = document.getElementById('bloxfruits-products');
            const b = document.getElementById('bloxfruits-permanent-fruits');
            document.getElementById('permanent-fruits-btn')?.classList.add('active');
            document.getElementById('gamepasses-btn')?.classList.remove('active');
            if(a) a.style.display = 'none'; if(b) b.style.display = '';
        };
        
        // default visible section
        show('robux');
        })();
        </script>

    <!-- Firebase SDK -->
    <script>
        // Suppress Cross-Origin-Opener-Policy console errors (they're not critical)
        const originalError = console.error;
        const originalWarn = console.warn;
        
        console.error = function(...args) {
            const message = args.join(' ');
            if (message.includes('Cross-Origin-Opener-Policy') || 
                message.includes('window.close call') ||
                message.includes('popup.ts')) {
                return; // Suppress these specific errors
            }
            originalError.apply(console, args);
        };
        
        console.warn = function(...args) {
            const message = args.join(' ');
            if (message.includes('Cross-Origin-Opener-Policy') || 
                message.includes('window.close call') ||
                message.includes('popup.ts')) {
                return; // Suppress these specific warnings
            }
            originalWarn.apply(console, args);
        };
    </script>
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js';
        import { getAuth, signInWithEmailAndPassword, createUserWithEmailAndPassword, signOut, onAuthStateChanged, sendPasswordResetEmail, GoogleAuthProvider, signInWithPopup, EmailAuthProvider, reauthenticateWithCredential, updatePassword, updateProfile } from 'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';
        import { getFirestore, collection, addDoc, getDocs, updateDoc, deleteDoc, doc, query, orderBy, onSnapshot, getDoc, setDoc, serverTimestamp, writeBatch, where } from 'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';

        // Firebase configuration - Using your existing config
        const firebaseConfigAdmin = {
            apiKey: "AIzaSyDD5xAiYZRu6X_ar-E1-22t6fpXtZHq5sM",
            authDomain: "egyptstore-f5201.firebaseapp.com",
            projectId: "egyptstore-f5201",
            storageBucket: "egyptstore-f5201.firebasestorage.app",
            messagingSenderId: "945330365902",
            appId: "1:945330365902:web:51be4549fa54cd7702379f",
            measurementId: "G-1M7Z20E2T4"
        };

        // Initialize Firebase
        const appAdmin = initializeApp(firebaseConfigAdmin);
        const authAdmin = getAuth(appAdmin);
        const dbAdmin = getFirestore(appAdmin);

        // Make Firebase available globally
        window.auth = authAdmin;
        window.db = dbAdmin;
        window.signInWithEmailAndPassword = signInWithEmailAndPassword;
        window.createUserWithEmailAndPassword = createUserWithEmailAndPassword;
        window.signOut = signOut;
        window.onAuthStateChanged = onAuthStateChanged;
        window.sendPasswordResetEmail = sendPasswordResetEmail;
        window.updateProfile = updateProfile;
        window.getFirestore = getFirestore;
        window.collection = collection;
        window.addDoc = addDoc;
        window.getDocs = getDocs;
        window.updateDoc = updateDoc;
        window.deleteDoc = deleteDoc;
        window.doc = doc;
        window.query = query;
        window.orderBy = orderBy;
        window.onSnapshot = onSnapshot;
        window.getDoc = getDoc;
        window.setDoc = setDoc;
        window.serverTimestamp = serverTimestamp;
        window.where = where; // Made globally accessible
        window.GoogleAuthProvider = GoogleAuthProvider; // Made globally accessible
        window.signInWithPopup = signInWithPopup; // Made globally accessible

        // Global variables for products
        let productsAdmin = [];
        let currentUserAdmin = null;
        
        // Make currentUserAdmin globally accessible
        window.currentUserAdmin = currentUserAdmin;

        // Initialize app when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize UI first (show login/register button)
            updateAuthUI();
            initializeFirebaseAuth();
            
            // Load products after a short delay to ensure Firebase is initialized
            setTimeout(() => {
                loadProducts();
            }, 500);
        });

        // Initialize Firebase and authentication
        function initializeFirebaseAuth() {
            // Check if Firebase is available
            if (typeof authAdmin === 'undefined') {
                console.error('Firebase not initialized');
                return;
            }

            // Listen for authentication state changes
            window.onAuthStateChanged(window.auth, (user) => {
                console.log('Auth state changed, user:', user);
                currentUserAdmin = user;
                window.currentUserAdmin = user; // Update global reference
                updateAuthUI();
            });
        }

        // Load products from Firebase
        function loadProducts() {
            if (typeof dbAdmin === 'undefined') {
                console.error('Firestore not initialized');
                return;
            }

            const productsRef = collection(dbAdmin, 'products');
            const q = query(productsRef, orderBy('createdAt', 'desc'));

            onSnapshot(q, (snapshot) => {
                productsAdmin = [];
                snapshot.forEach((doc) => {
                    productsAdmin.push({ id: doc.id, ...doc.data() });
                });
                renderProducts();
            });
        }

        // Hide static products to prevent flash of old content
        function hideStaticProducts() {
            const staticProductSections = [
                'robux-products',
                'bloxfruits-products', 
                'bloxfruits-permanent-fruits',
                'mm2-product-grid',
                'garden-products'
            ];
            
            staticProductSections.forEach(sectionId => {
                const section = document.getElementById(sectionId);
                if (section) {
                    // Remove class to hide static products
                    section.classList.remove('show-static-products');
                }
            });
        }

        // Show static products as fallback
        function showStaticProducts() {
            const staticProductSections = [
                'robux-products',
                'bloxfruits-products', 
                'bloxfruits-permanent-fruits',
                'mm2-product-grid',
                'garden-products'
            ];
            
            staticProductSections.forEach(sectionId => {
                const section = document.getElementById(sectionId);
                if (section) {
                    // Add class to show static products
                    section.classList.add('show-static-products');
                }
            });
        }

        // Render products dynamically
        function renderProducts() {
            // Clear existing products
            const productSections = {
                'robux': document.getElementById('robux-products'),
                'bloxfruits': document.getElementById('bloxfruits-products'),
                'mm2': document.getElementById('mm2-product-grid'),
                'garden': document.getElementById('garden-products')
            };

            // Clear all sections
            Object.values(productSections).forEach(section => {
                if (section) {
                    section.innerHTML = '';
                }
            });

            // Group products by category
            const productsByCategory = {
                robux: productsAdmin.filter(p => p.category === 'robux'),
                bloxfruits: productsAdmin.filter(p => p.category === 'bloxfruits'),
                mm2: productsAdmin.filter(p => p.category === 'mm2'),
                garden: productsAdmin.filter(p => p.category === 'garden')
            };

            // Render each category (excluding Blox Fruits - handled separately)
            Object.keys(productsByCategory).forEach(category => {
                if (category === 'bloxfruits') return; // Skip Blox Fruits - handled below
                
                const section = productSections[category];
                if (section) {
                    productsByCategory[category].forEach(product => {
                        const productCard = createProductCard(product);
                        section.appendChild(productCard);
                    });
                }
            });

            // Handle Blox Fruits subcategories separately
            const bloxfruitsProducts = productsByCategory.bloxfruits.filter(p => p.subcategory === 'gamepasses');
            const permanentFruits = productsByCategory.bloxfruits.filter(p => p.subcategory === 'permanent-fruits');
            
            const bloxfruitsGrid = document.getElementById('bloxfruits-products');
            const permanentFruitsGrid = document.getElementById('bloxfruits-permanent-fruits');
            
            if (bloxfruitsGrid) {
                bloxfruitsProducts.forEach(product => {
                    const productCard = createProductCard(product);
                    bloxfruitsGrid.appendChild(productCard);
                });
            }
            
            if (permanentFruitsGrid) {
                permanentFruits.forEach(product => {
                    const productCard = createProductCard(product);
                    permanentFruitsGrid.appendChild(productCard);
                });
            }
        }

        // Create product card based on category
        function createProductCard(product) {
            const card = document.createElement('div');
            
            if (product.category === 'mm2') {
                // MM2 specific card
                card.className = 'mm2-product-card firebase-product';
                card.innerHTML = `
                    <div class="mm2-product-image">
                        ${product.image ? `<img src="${product.image}" alt="${product.name}" style="width: 100%; height: 100%; object-fit: contain;">` : '<i class="fas fa-image"></i>'}
                    </div>
                    <div class="mm2-product-content">
                        ${product.brand ? `<span class="tier-badge tier-${product.brand.toLowerCase().replace('tier ', '')}">${product.brand}</span>` : ''}
                        <h3 class="mm2-product-title">${product.name}</h3>
                        <div class="mm2-product-price">${product.price} EGP</div>
                        <button class="mm2-btn-buy" onclick="openSocialOrderModal()">Buy Now</button>
                    </div>
                `;
            } else {
                // Standard product card
                card.className = 'product-card firebase-product';
                card.innerHTML = `
                    <div class="product-image">
                        ${product.image ? `<img src="${product.image}" alt="${product.name}" style="width: 100%; height: 100%; object-fit: contain;">` : '<i class="fas fa-coins"></i>'}
                        ${product.brand ? `<div class="product-badge">${product.brand}</div>` : ''}
                    </div>
                    <div class="product-content">
                        <h3 class="product-title">${product.name}</h3>
                        <p class="product-desc">${product.description || 'Digital product'}</p>
                        <div class="product-price">${product.price}</div>
                        ${product.category === 'robux' ? '<div class="product-tax-note">بيتم خصم %30 من كميه الروبكس اللي انت شاريها بسبب روبلوكس يعني لو شاري 1000 بيوصلك 700</div>' : ''}
                        <div class="product-actions">
                            <button class="btn-product btn-buy" onclick="openSocialOrderModal()">
                                <i class="fas fa-shopping-cart"></i> Buy Now
                            </button>
                        </div>
                    </div>
                `;
            }
            
            return card;
        }

        // Update authentication UI
        function updateAuthUI() {
            // Update the user menu based on authentication state
            console.log('updateAuthUI called, currentUserAdmin:', currentUserAdmin);
            const userMenu = document.getElementById('userMenu');
            if (!userMenu) {
                console.log('User menu not found - skipping UI update');
                return;
            }
            
            if (currentUserAdmin) {
                // User is logged in - show user info and settings
                const initials = (currentUserAdmin.name || currentUserAdmin.email || 'U').charAt(0).toUpperCase();
                const adminEmails = ['mohamedmagdyroblox@gmail.com', 'shadowbr500@gmail.com'];
                const adminBadge = adminEmails.includes(currentUserAdmin.email) ? ' <span class="admin-badge">Admin</span>' : '';
                
                // Show admin panel for your Google emails
                if (adminEmails.includes(currentUserAdmin.email)) {
                    document.getElementById('adminAccess').style.setProperty('display', 'flex', 'important');
                    document.getElementById('adminAccessBtn').style.setProperty('display', 'flex', 'important');
                } else {
                    document.getElementById('adminAccess').style.setProperty('display', 'none', 'important');
                    document.getElementById('adminAccessBtn').style.setProperty('display', 'none', 'important');
                }
                
                userMenu.innerHTML = `
                    <div class="user-info">
                        <div class="user-avatar">${initials}</div>
                        <span>${currentUserAdmin.name || currentUserAdmin.email}${adminBadge}</span>
                    </div>
                    <button class="btn btn-outline header-auth-btn" onclick="openSocialOrderModal()">
                        <i class="fas fa-cog"></i> Settings
                    </button>
                    <button class="btn btn-outline" onclick="openSocialOrderModal()">
                        <i class="fas fa-sign-out-alt"></i> Logout
                    </button>
                `;
            } else {
                // User is not logged in - hide admin panel and show login button
                document.getElementById('adminAccess').style.setProperty('display', 'none', 'important');
                document.getElementById('adminAccessBtn').style.setProperty('display', 'none', 'important');
                userMenu.innerHTML = `
                    <button class="btn btn-outline header-auth-btn" onclick="openSocialOrderModal()">
                        <i class="fas fa-sign-in-alt"></i> Login / Register
                    </button>
                    <div class="auth-dropdown" id="authDropdown">
                        <div class="auth-tabs">
                            <div class="auth-tab active" onclick="openSocialOrderModal()">Login</div>
                            <div class="auth-tab" onclick="openSocialOrderModal()">Register</div>
                        </div>
                        
                        <form id="loginForm" class="auth-form active" onsubmit="loginUser(event); return false;">
                            <div class="form-group">
                                <label>Email</label>
                                <input type="email" id="loginEmail" placeholder="Your email" required>
                            </div>
                            
                            <div class="form-group">
                                <label>Password</label>
                                <input type="password" id="loginPassword" placeholder="Your password" required>
                            </div>
                            
                            <button type="submit" class="btn-auth">Login</button>
                            
                            <div class="auth-links">
                                <a href="#" onclick="openSocialOrderModal()">Forgot Password?</a>
                            </div>
                            
                            <div class="auth-divider">
                                <span>Or continue with</span>
                            </div>
                            
                            <button type="button" class="btn-google" onclick="openSocialOrderModal()">
                                <i class="fab fa-google"></i> Sign in with Google
                            </button>
                        </form>
                        
                        <form id="registerForm" class="auth-form" onsubmit="registerUser(event); return false;">
                            <div class="form-group">
                                <label>Full Name</label>
                                <input type="text" id="registerName" placeholder="Your full name" required>
                            </div>
                            
                            <div class="form-group">
                                <label>Username</label>
                                <input type="text" id="registerUsername" placeholder="Choose a username" required>
                            </div>
                            
                            <div class="form-group">
                                <label>Email</label>
                                <input type="email" id="registerEmail" placeholder="Your email" required>
                            </div>
                            
                            <div class="form-group">
                                <label>Password</label>
                                <input type="password" id="registerPassword" placeholder="Create a password" required>
                            </div>
                            
                            <div class="form-group">
                                <label>Confirm Password</label>
                                <input type="password" id="confirmPassword" placeholder="Confirm your password" required>
                            </div>
                            
                            <button type="submit" class="btn-auth">Register</button>
                            
                            <div class="auth-divider">
                                <span>Or continue with</span>
                            </div>
                            
                            <button type="button" class="btn-google" onclick="openSocialOrderModal()">
                                <i class="fab fa-google"></i> Sign in with Google
                            </button>
                        </form>
                    </div>
                `;
            }
        }

        // Make updateAuthUI globally accessible
        window.updateAuthUI = updateAuthUI;

        // Authentication functions
        function logout() {
            window.signOut(window.auth).then(() => {
                showNotification('Logged out successfully!', 'success');
            }).catch((error) => {
                console.error('Logout error:', error);
                showNotification('Logout failed: ' + error.message, 'error');
            });
        }

        // Notification system
        function showNotification(message, type = 'info') {
            // Create notification element if it doesn't exist
            let notification = document.getElementById('notification');
            if (!notification) {
                notification = document.createElement('div');
                notification.id = 'notification';
                notification.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    padding: 1rem 2rem;
                    border-radius: 8px;
                    color: white;
                    font-weight: 600;
                    z-index: 3000;
                    transform: translateX(400px);
                    transition: transform 0.3s ease;
                `;
                document.body.appendChild(notification);
            }
            
            notification.textContent = message;
            notification.className = `notification ${type}`;
            notification.classList.add('show');

            setTimeout(() => {
                notification.classList.remove('show');
            }, 5000);
        }

        // Product Management Functions
        let currentProduct = null;

        window.loadProductsTable = function loadProductsTable() {
            if (typeof window.db === 'undefined') {
                console.error('Firestore not initialized');
                return;
            }

            const productsRef = collection(window.db, 'products');
            const q = query(productsRef, orderBy('createdAt', 'desc'));

            onSnapshot(q, (snapshot) => {
                const tbody = document.getElementById('productsTableBody');
                if (!tbody) return;

                if (snapshot.empty) {
                    tbody.innerHTML = '<tr><td colspan="6" style="text-align: center; padding: 20px;">No products found</td></tr>';
                    return;
                }

                tbody.innerHTML = '';
                snapshot.forEach((doc) => {
                    const product = { id: doc.id, ...doc.data() };
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>
                            <img src="${product.image || 'https://via.placeholder.com/50x50?text=No+Image'}" 
                                 alt="${product.name}" style="width: 50px; height: 50px; object-fit: cover; border-radius: 5px;">
                        </td>
                        <td>${product.name}</td>
                        <td>${product.category}${product.subcategory ? ' - ' + product.subcategory : ''}</td>
                        <td>${product.price} EGP</td>
                        <td>
                            <span style="padding: 0.3rem 0.8rem; border-radius: 20px; font-size: 0.8rem; font-weight: 600; background: ${product.active !== false ? '#d4edda' : '#f8d7da'}; color: ${product.active !== false ? '#155724' : '#721c24'};">
                                ${product.active !== false ? 'Active' : 'Inactive'}
                            </span>
                        </td>
                        <td>
                            <button class="btn btn-small" onclick="openSocialOrderModal()" style="margin-right: 5px;">
                                <i class="fas fa-edit"></i> Edit
                            </button>
                            <button class="btn btn-danger btn-small" onclick="openSocialOrderModal()">
                                <i class="fas fa-trash"></i> Delete
                            </button>
                        </td>
                    `;
                    tbody.appendChild(row);
                });
            });
        }

        window.openProductModal = function openProductModal(productId = null) {
            console.log('openProductModal called with productId:', productId);
            const modal = document.getElementById('productModal');
            const form = document.getElementById('productForm');
            const title = document.getElementById('productModalTitle');
            
            if (!modal) {
                console.error('Product modal not found');
                return;
            }
            
            if (productId) {
                // Edit mode - find product in current products
                const product = productsAdmin.find(p => p.id === productId);
                if (product) {
                    currentProduct = product;
                    title.textContent = 'Edit Product';
                    populateProductForm(product);
                }
            } else {
                // Add mode
                title.textContent = 'Add New Product';
                form.reset();
                currentProduct = null;
            }
            
            modal.classList.add('active');
            console.log('Product modal opened');
        }

        window.closeProductModal = function closeProductModal() {
            document.getElementById('productModal').classList.remove('active');
            currentProduct = null;
        }

        function populateProductForm(product) {
            document.getElementById('productName').value = product.name || '';
            document.getElementById('productCategory').value = product.category || '';
            document.getElementById('productSubcategory').value = product.subcategory || '';
            document.getElementById('productPrice').value = product.price || '';
            document.getElementById('productBrand').value = product.brand || '';
            document.getElementById('productDescription').value = product.description || '';
            document.getElementById('productImage').value = product.image || '';
            document.getElementById('productActive').checked = product.active !== false;
        }

        window.saveProduct = function saveProduct(event) {
            event.preventDefault();
            
            const productData = {
                name: document.getElementById('productName').value,
                category: document.getElementById('productCategory').value,
                subcategory: document.getElementById('productSubcategory').value || null,
                price: parseFloat(document.getElementById('productPrice').value),
                brand: document.getElementById('productBrand').value || null,
                description: document.getElementById('productDescription').value || null,
                image: document.getElementById('productImage').value || null,
                active: document.getElementById('productActive').checked,
                updatedAt: new Date()
            };

            if (currentProduct) {
                // Update existing product
                updateDoc(doc(dbAdmin, 'products', currentProduct.id), productData)
                    .then(() => {
                        showNotification('Product updated successfully!', 'success');
                        closeProductModal();
                    })
                    .catch((error) => {
                        console.error('Error updating product:', error);
                        showNotification('Error updating product: ' + error.message, 'error');
                    });
            } else {
                // Add new product
                productData.createdAt = new Date();
                addDoc(collection(dbAdmin, 'products'), productData)
                    .then(() => {
                        showNotification('Product added successfully!', 'success');
                        closeProductModal();
                    })
                    .catch((error) => {
                        console.error('Error adding product:', error);
                        showNotification('Error adding product: ' + error.message, 'error');
                    });
            }
        }

        window.editProduct = function editProduct(productId) {
            openProductModal(productId);
        }

        window.deleteProduct = function deleteProduct(productId) {
            if (confirm('Are you sure you want to delete this product?')) {
                deleteDoc(doc(window.db, 'products', productId))
                    .then(() => {
                        showNotification('Product deleted successfully!', 'success');
                    })
                    .catch((error) => {
                        console.error('Error deleting product:', error);
                        showNotification('Error deleting product: ' + error.message, 'error');
                    });
            }
        }

        function filterProducts() {
            const searchTerm = document.getElementById('productSearch').value.toLowerCase();
            const categoryFilter = document.getElementById('productFilter').value;
            const rows = document.querySelectorAll('#productsTableBody tr');
            
            rows.forEach(row => {
                const name = row.cells[1]?.textContent.toLowerCase() || '';
                const category = row.cells[2]?.textContent.toLowerCase() || '';
                
                const matchesSearch = name.includes(searchTerm);
                const matchesCategory = categoryFilter === 'all' || category.includes(categoryFilter);
                
                row.style.display = (matchesSearch && matchesCategory) ? '' : 'none';
            });
        }

        // Make filterProducts globally accessible
        window.filterProducts = filterProducts;
    </script>
    
</body>

</html>
